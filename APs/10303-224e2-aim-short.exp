(***********************************************************************
AIM EXPRESS short form for ISO/IS 10303-224 ed2
Len Slovensky
2000-12-01
ISO TC184/SC4/WG3 N999
***********************************************************************)

SCHEMA feature_based_process_planning;
  USE FROM action_schema                          -- ISO 10303-41
      (action_directive,
       action_method,
       action_relationship,
       action_request_solution, 
       action_request_status,
       action_status,
       directed_action,
       versioned_action_request);
  USE FROM aic_advanced_brep                               -- ISO 10303-514
       (advanced_brep_shape_representation);
  USE FROM aic_topologically_bounded_surface               -- ISO 10303-511
       (advanced_face);
  USE FROM aic_geometric_tolerances                        -- ISO 10303-519
      (angularity_tolerance,
       concentricity_tolerance,
       circular_runout_tolerance,
       cylindricity_tolerance,
       flatness_tolerance,
       line_profile_tolerance,
       parallelism_tolerance,
       perpendicularity_tolerance,
       position_tolerance,
       roundness_tolerance,
       straightness_tolerance,
       surface_profile_tolerance,
       symmetry_tolerance,
       total_runout_tolerance);
  USE FROM application_context_schema                     -- ISO 10303-41
      (application_context,
       application_protocol_definition); 
  USE FROM approval_schema                              -- ISO 10303-41
      (approval,
       approval_date_time,
       approval_person_organization,
       approval_status);
        
  REFERENCE FROM basic_attribute_schema              -- ISO 10303-41
     (description_attribute,
     object_role,
     role_association);
  
  USE FROM date_time_schema                       -- ISO 10303-41
      (date,
       calendar_date,
       ordinal_date,
       week_of_year_and_day_date);
  USE FROM document_schema                        -- ISO 10303-41
      (document,
       document_representation_type,
       document_with_class,
       document_usage_constraint,
       document_relationship);
  USE FROM external_reference_schema              -- ISO 10303-41
      (externally_defined_item);   
  USE FROM geometric_model_schema                 -- ISO 10303-42
      (brep_with_voids,
       manifold_solid_brep);
  REFERENCE FROM geometry_schema                  -- ISO 10303-42
      (dummy_gri);
  USE FROM geometry_schema                        -- ISO 10303-42
      (axis2_placement_2d,
       axis2_placement_3d,
       bezier_curve,
       bezier_surface,
       b_spline_curve_with_knots,
       b_spline_surface_with_knots,
       cartesian_point,
       cartesian_transformation_operator_3d,
       circle,
       conical_surface,
       cylindrical_surface,
       degenerate_toroidal_surface,
       direction,
       ellipse,
       geometric_representation_context,
       hyperbola,
       line,
       parabola,
       pcurve,
       plane,
       point,
       polyline,
       quasi_uniform_curve,
       quasi_uniform_surface,
       rational_b_spline_curve,
       rational_b_spline_surface,
       spherical_surface,
       surface_curve,
       surface_of_linear_extrusion,
       surface_of_revolution,
       swept_surface,
       toroidal_surface,
       uniform_curve,
       uniform_surface,
       vector);
  USE FROM group_schema                           -- ISO 10303-41
      (group,
       group_relationship);
  USE FROM management_resources_schema            -- ISO 10303-41
      (action_assignment,
       action_request_assignment,
       approval_assignment,
       date_assignment,
       document_reference,
       document_usage_constraint_assignment,
       group_assignment,
       organization_assignment,
       person_and_organization_assignment,
       security_classification_assignment);
  USE FROM material_property_representation_schema
      (material_property_representation);
  USE FROM material_property_definition_schema    -- ISO 10303-45
      (material_designation,
       material_property,
       property_definition_relationship);
        
  USE FROM measure_schema                         -- ISO 10303-41
      (context_dependent_measure,
       context_dependent_unit,
       conversion_based_unit,
       count_measure, 
       derived_unit,
       descriptive_measure,
       global_unit_assigned_context,
       length_measure_with_unit,
       length_unit, 
       measure_with_unit,
       named_unit, 
       parameter_value,
       plane_angle_measure_with_unit,
       plane_angle_unit, 
       positive_plane_angle_measure, 
       ratio_measure,
       ratio_measure_with_unit,
       ratio_unit,
       si_unit,
       solid_angle_measure_with_unit,
       solid_angle_unit);  
  USE FROM person_organization_schema             -- ISO 10303-41
      (organizational_address,
       person_and_organization,
       personal_address);
  USE FROM product_definition_schema              -- ISO 10303-41
      (product,
       product_definition,
       product_definition_formation,
       product_definition_with_associated_documents);
  USE FROM product_property_definition_schema     -- ISO 10303-41
      (characterized_object,
       product_definition_shape, 
       property_definition,   
       shape_aspect,
       shape_aspect_relationship);
  USE FROM product_property_representation_schema -- ISO 10303-41
      (property_definition_representation,
       shape_definition_representation,
       shape_representation);
  USE FROM product_structure_schema               -- ISO 10303-44
      (assembly_component_usage,
       next_assembly_usage_occurrence,
       make_from_usage_option);
  USE FROM qualified_measure_schema               -- ISO 10303-45
      (descriptive_representation_item,
       expanded_uncertainty,
       measure_representation_item,
       measure_qualification,
       precision_qualifier,
       qualified_representation_item,
       qualitative_uncertainty,
       standard_uncertainty,
       type_qualifier,
       uncertainty_qualifier);
  USE FROM representation_schema                  -- ISO 10303-43
      (definitional_representation,
       global_uncertainty_assigned_context,
       mapped_item,
       parametric_representation_context,
       representation,
       representation_item,
       representation_relationship);
  USE FROM security_classification_schema         -- ISO 10303-41
      (security_classification,
       security_classification_level);
  USE FROM shape_aspect_definition_schema         -- ISO 10303-47
      (composite_shape_aspect,
       datum_feature,
       datum_reference,
       datum_target,
       referenced_modified_datum,
       datum);
  USE FROM shape_dimension_schema                 -- ISO 10303-47
      (angular_location,
       angular_size,
       dimensional_characteristic_representation,
       dimensional_location,
       dimensional_location_with_path,
       dimensional_size,
       dimensional_size_with_path,
       shape_dimension_representation);
  USE FROM shape_tolerance_schema                 -- ISO 10303-47
      (geometric_tolerance,
       geometric_tolerance_relationship,
       geometric_tolerance_with_datum_reference,
       geometric_tolerance_with_defined_unit,
       limits_and_fits,
       modified_geometric_tolerance,
       plus_minus_tolerance,
       projected_zone_definition,
       runout_zone_definition,
       runout_zone_orientation,
       tolerance_value,
       tolerance_zone,
       tolerance_zone_definition);  
  USE FROM support_resource_schema                -- ISO 10303-41
      (identifier,
       label,
       text);
  REFERENCE FROM topology_schema                  -- ISO 10303-42
      (dummy_tri);
  USE FROM topology_schema                        -- ISO 10303-42
      (closed_shell,
       connected_face_set,
       oriented_closed_shell,
       edge_curve,
       edge_loop,
       face_bound,
       face_outer_bound,
       face_surface,
       path,
       vertex_loop,
       vertex_point);
TYPE document_reference_item = SELECT
  (action_method,
   externally_defined_feature_definition,
   directed_action,
   dimensional_characteristic_representation,
   property_definition);
END_TYPE;
TYPE feature_based_pp_action_item = SELECT
  (product_definition_formation);
END_TYPE;
TYPE feature_based_pp_action_request_item = SELECT
  (product_definition_formation);
END_TYPE;
TYPE feature_based_pp_approved_item = SELECT
  (directed_action,
   product_definition_formation);
END_TYPE;
TYPE feature_based_pp_classified_item = SELECT
  (product_definition_formation);
END_TYPE;
TYPE feature_based_pp_dated_item = SELECT
  (directed_action,
   document,
   versioned_action_request);
END_TYPE;
TYPE feature_based_pp_ordered_item = SELECT
  (product_definition_formation);
END_TYPE;
TYPE feature_based_pp_organization_item = SELECT
  (action_directive,
   product_definition_formation);
END_TYPE;
TYPE feature_based_pp_person_and_organization_item = SELECT
  (action_directive, product_definition_formation);
END_TYPE;
  TYPE group_item = SELECT
    (instanced_feature, replicate_feature, transition_feature);
  END_TYPE;
  ENTITY applied_area
    SUBTYPE OF (shape_aspect);
    WHERE
      wr1: ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE'
           IN TYPEOF(SELF.of_shape));
      wr2: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
           IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0);
      wr3: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | ((
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') IN TYPEOF(pdr.
           used_representation)) ) |  
           (NOT({2 <= SIZEOF(impl_rep.used_representation.items) <= 3} )
            ) )) = 0)) )) = 0);
    wr4:  SIZEOF( QUERY( pd <* USEDIN( SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
          (SIZEOF( QUERY( pdr <* USEDIN( pd, 
          'FEATURE_BASED_PROCESS_PLANNING.' + 
          'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
          ('FEATURE_BASED_PROCESS_PLANNING.' + 
          'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
          IN TYPEOF(pdr.used_representation)) AND
          (SIZEOF( QUERY( srwp_i <* pdr.used_representation.items |
          NOT (srwp_i.name IN ['orientation','effective length', 
          'maximum length']) )) > 0 ) )) = 0 )   )) = 0;
      wr5: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
           IN TYPEOF(pdr.used_representation)) ) | 
         (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
           ((SIZEOF([
           'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
           'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
         TYPEOF(it)) = 2) AND (it.name = 'effective length')) )) = 1)) )) 
           = 0)) )) <= 1);
      wr6: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
           IN TYPEOF(pdr.used_representation)) ) | 
          (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
           ((SIZEOF([
           'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
           'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
          TYPEOF(it)) = 2) AND (it.name = 'maximum length')) )) <= 1)) )) 
           = 0)) )) = 0);
      wr7: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
           IN TYPEOF(pdr.used_representation)) ) | 
          (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
           (('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' 
           IN TYPEOF(it))  AND (it.name = 'orientation')) )) = 1)) )) 
           = 0)) )) = 0);
  END_ENTITY; -- applied_area
ENTITY applied_document_reference
  SUBTYPE OF (document_reference);
  items : SET [1:?] OF document_reference_item;
END_ENTITY;
ENTITY applied_document_usage_constraint_assignment
  SUBTYPE OF (document_usage_constraint_assignment);
  items : SET [1:?] OF document_reference_item;
END_ENTITY;
ENTITY applied_group_assignment
  SUBTYPE OF (group_assignment);
  items : SET [1:?] OF group_item;
END_ENTITY;
  ENTITY block_shape_representation
    SUBTYPE OF (shape_representation_with_parameters);
    WHERE
      wr1: (SIZEOF(SELF.items) = 4);
      wr2: (SIZEOF(QUERY ( it <* SELF.items | 
           (('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' 
           IN TYPEOF(it)) AND (it.name = 'orientation')) )) = 1);
      wr3: (SIZEOF(QUERY ( it <* SELF.items | 
           ((SIZEOF(
           ['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
           'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
            TYPEOF(it)) = 2) AND (it.name = 'length')) )) = 1);
      wr4: (SIZEOF(QUERY ( it <* SELF.items | 
           ((SIZEOF([
           'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
           'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
           TYPEOF(it)) = 2) AND (it.name = 'width')) )) = 1);
      wr5: (SIZEOF(QUERY ( it <* SELF.items | 
           ((SIZEOF([
           'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
           'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
           TYPEOF(it)) = 2) AND (it.name = 'height')) )) = 1);
  END_ENTITY; -- block_shape_representation
  ENTITY boss
    SUBTYPE OF (feature_definition);
    WHERE   
      WR1: SELF\characterized_object.description IN 
           ['circular', 'complex', 'rectangular'];
      WR2: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
          'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
          TYPEOF (pd)) |
          NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds, 
          'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
          (sa_occ.description = 'boss height occurrence') AND
          (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ, 
          'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
          'RELATED_SHAPE_ASPECT') |
          (sar.description = 'path feature component usage') AND 
          ('FEATURE_BASED_PROCESS_PLANNING.' +
          'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
          ('FEATURE_BASED_PROCESS_PLANNING.PATH_FEATURE_COMPONENT' IN
          TYPEOF (sdr.relating_shape_aspect)) AND
          (sdr.relating_shape_aspect.description = 'linear') AND
          (sdr.name = 'boss height'))) = 1))) = 1))) = 0; 
    WR3:  SIZEOF( QUERY( pd <* USEDIN( SELF, 
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
          SIZEOF( QUERY( pdr <* USEDIN( pd, 
         'FEATURE_BASED_PROCESS_PLANNING.' +
         'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
         ('FEATURE_BASED_PROCESS_PLANNING.'+
         'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
         IN TYPEOF(pdr.used_representation)) AND
        ({1 <= SIZEOF(pdr.used_representation.items) <= 2} ) )) = 1 )) = 1;
   WR4:  SIZEOF( QUERY( pd <* USEDIN( SELF, 
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
         SIZEOF( QUERY( pdr <* USEDIN( pd, 
         'FEATURE_BASED_PROCESS_PLANNING.' +
         'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
         ('FEATURE_BASED_PROCESS_PLANNING.'+
         'SHAPE_REPRESENTATION_WITH_PARAMETERS' IN
         TYPEOF(pdr.used_representation)) AND
         (SIZEOF( QUERY( srwp_i <* pdr.used_representation.items |
         (srwp_i.name = 'orientation') OR
         (srwp_i.name = 'fillet radius'))) 
         = SIZEOF(pdr.used_representation.items)) )) = 1 )) = 1;
   WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
        NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
        'FEATURE_BASED_PROCESS_PLANNING.' +
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
        'FEATURE_BASED_PROCESS_PLANNING.' +
        'SHAPE_REPRESENTATION_WITH_PARAMETERS'
        IN TYPEOF (pdr.used_representation)) |
        NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
        (SIZEOF (
        ['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
        TYPEOF (it)) = 2) AND (it.name = 'fillet radius'))) <= 1))) 
        = 0))) = 0;
   WR6: (NOT (SELF\characterized_object.description = 'circular')) OR
        (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
        'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
        IN TYPEOF (pd)) |
        NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds, 
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
        (sa_occ.description = 'circular profile occurrence') AND
        (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ, 
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
        'RELATED_SHAPE_ASPECT') |
        (sar.description = 'profile usage') AND 
        ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP' 
        IN TYPEOF (sar))) |
        'FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_CLOSED_PROFILE' 
        IN TYPEOF (sdr.relating_shape_aspect))) = 1))) = 1))) = 0);
   WR7: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
        'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
        TYPEOF (pd)) | 
        NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds, 
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
        (sa_occ.description = 'top condition occurrence') AND
        (SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (sa_occ, 
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
        'RELATED_SHAPE_ASPECT') |
        (sar.description = 'boss top usage') AND
        ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
        IN TYPEOF (sar))) |'FEATURE_BASED_PROCESS_PLANNING.BOSS_TOP' 
        IN TYPEOF (fcr.relating_shape_aspect))) = 1))) = 1))) = 0;
   WR8: (NOT (SELF\characterized_object.description = 'circular')) OR
        (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
        'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
        TYPEOF (pd)) | 
        NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds, 
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
        (sa_occ.description = 'change in diameter occurrence') AND
        (SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (sa_occ, 
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
        'RELATED_SHAPE_ASPECT') |
        (sar.description = 'taper usage') AND
        ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
        IN TYPEOF (sar))) | 'FEATURE_BASED_PROCESS_PLANNING.TAPER' 
        IN TYPEOF (fcr.related_shape_aspect)) )= 1))) <= 1))) = 0);
  WR9: (NOT (SELF\characterized_object.description = 'complex')) OR
        (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
        'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
        TYPEOF (pd)) | 
        NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds, 
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
        (sa_occ.description = 'enclosed boundary occurrence') AND
        (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ, 
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
        'RELATED_SHAPE_ASPECT') |
        (sar.description = 'profile usage') AND
        ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP' 
        IN TYPEOF (sar))) |
        SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.NGON_CLOSED_PROFILE',
        'FEATURE_BASED_PROCESS_PLANNING.CLOSED_PATH_PROFILE'] *  
        TYPEOF (sdr.relating_shape_aspect)) = 1)) = 1)))= 1))) = 0);
  WR10: (NOT (SELF\characterized_object.description 
        IN ['complex','rectangular'])) OR
        (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
        'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
        IN TYPEOF (pd)) | 
        NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds, 
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
        (sa_occ.description = 'change in boundary occurrence') AND
        (SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (sa_occ, 
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
        'RELATING_SHAPE_ASPECT') |
        (sar.description = 'taper usage') AND
        ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
        IN TYPEOF (sar))) |
        ('FEATURE_BASED_PROCESS_PLANNING.TAPER' 
        IN TYPEOF (fcr.related_shape_aspect)) AND
        (fcr.related_shape_aspect.description IN 
        ['angle taper','directed taper']))) 
        = 1))) <= 1))) = 0);
  WR11: (NOT (SELF\characterized_object.description = 'rectangular')) OR
        (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
        'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
        IN TYPEOF (pd)) |
        NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds, 
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
        (sa_occ.description = 'rectangular profile occurrence') AND
        (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ, 
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
        'RELATED_SHAPE_ASPECT') |
        (sar.description = 'profile usage') AND 
        ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP' 
        IN TYPEOF (sar))) |
        'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_CLOSED_PROFILE' 
        IN TYPEOF (sdr.relating_shape_aspect))) = 1))) = 1))) = 0);
  END_ENTITY;  -- Boss
  ENTITY boss_top
    SUBTYPE OF (shape_aspect);
    WHERE
      wr1: ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
            IN TYPEOF(SELF.of_shape.definition));
      wr2: (SELF.description IN ['planar','complex']);
      wr3: ((NOT (SELF.description = 'planar')) OR 
           (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
         (('FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION') 
           IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0));
      wr4: ((NOT (SELF.description = 'planar')) OR 
           (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
          (('FEATURE_BASED_PROCESS_PLANNING.LOCATION_SHAPE_REPRESENTATION') 
           IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0));
      wr5: (NOT (SELF.description = 'complex')) OR 
           (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.'+
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION') 
           IN TYPEOF(pdr.used_representation) )) = 1)) )) = 0);
      wr6: (SIZEOF(QUERY ( fcr <* QUERY ( sar <* USEDIN(SELF,
           'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.'  + 
           'RELATING_SHAPE_ASPECT') | 
           ((sar.description = 'boss top usage') AND
           (sar.name  IN ['boss height start','boss height end']))AND
           ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
           IN TYPEOF(sar)))  | 
           ((fcr.related_shape_aspect.description = 
           'top condition occurrence') AND 
           ('FEATURE_BASED_PROCESS_PLANNING.BOSS' 
           IN TYPEOF(fcr.related_shape_aspect.of_shape.definition))) )) 
           >= 1);
      wr7: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |  
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
           IN TYPEOF(pdr.used_representation)) )) <= 1)) )) = 0);
      wr8: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
           IN TYPEOF(pdr.used_representation)) ) | 
           (NOT (SIZEOF(impl_rep.used_representation.items) = 1)) )) 
           = 0)) )) = 0);
   WR9: SIZEOF (QUERY (pd <* USEDIN (SELF, 
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
        NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
        'FEATURE_BASED_PROCESS_PLANNING.' +
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
        'FEATURE_BASED_PROCESS_PLANNING.' +
        'SHAPE_REPRESENTATION_WITH_PARAMETERS'
        IN TYPEOF (pdr.used_representation)) |
        NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
        (SIZEOF (
        ['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
        TYPEOF (it)) = 2) AND (it.name = 'top radius'))) <= 1))) 
        = 0))) = 0;
  END_ENTITY; -- boss_top 
  ENTITY chamfer
    SUBTYPE OF (transition_feature);
    WHERE
      wr1: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION' 
           IN TYPEOF(pdr.used_representation)) AND 
        (pdr.used_representation.name = 'chamfer face')) )) = 1)) )) = 0);
      wr2: (SIZEOF(QUERY ( fcr <* QUERY ( sar <* USEDIN(SELF,
           'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
           'RELATING_SHAPE_ASPECT') |
           ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
           IN TYPEOF(sar)) ) | 
           (('FEATURE_BASED_PROCESS_PLANNING.CHAMFER_OFFSET' 
           IN TYPEOF(fcr.related_shape_aspect)) AND 
          (fcr.related_shape_aspect.description = 'first offset')) )) = 1);
      wr3: (SIZEOF(QUERY ( fcr <* QUERY ( sar <* USEDIN(SELF,
           'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
           'RELATING_SHAPE_ASPECT') |
           ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
           IN TYPEOF(sar)) ) | 
           (('FEATURE_BASED_PROCESS_PLANNING.CHAMFER_OFFSET' 
           IN TYPEOF(fcr.related_shape_aspect)) AND 
           (fcr.related_shape_aspect.description = 'second offset')) )) = 1);
  END_ENTITY; -- chamfer
  ENTITY chamfer_offset
    SUBTYPE OF (shape_aspect);
    WHERE
      wr1: (SELF.description IN ['first offset','second offset']);
      wr2: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
           IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0);
      wr3: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
           IN TYPEOF(pdr.used_representation)) ) | 
           (NOT (SIZEOF(impl_rep.used_representation.items) = 1)) )) 
           = 0)) )) = 0);
      wr4: ((NOT (SELF.description = 'first offset')) OR 
           (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
           IN TYPEOF(pdr.used_representation)) ) | 
           (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
           ((SIZEOF([
           'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
           'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
           TYPEOF(it)) = 2) AND (it.name = 'offset amount')) )) = 1)) )) 
           = 0)) )) = 0));
      wr5: ((NOT (SELF.description = 'first offset')) OR 
           (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |  
           (('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION' 
           IN TYPEOF(pdr.used_representation)) AND 
           (pdr.used_representation.name = 'first face shape')) )) = 1)) )) 
           = 0));
      wr6: ((NOT (SELF.description = 'second offset')) OR 
           (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
           IN TYPEOF(pdr.used_representation)) ) | 
           (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
           (((SIZEOF([
           'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
           'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
           TYPEOF(it)) = 2) AND (it.name = 'offset amount')) OR 
           ((SIZEOF([
           'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
           'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] 
           * TYPEOF(it)) = 2) AND (it.name = 'offset angle'))) )) = 1)) )) 
           = 0)) )) = 0));
 
      wr7: ((NOT (SELF.description = 'second offset')) OR 
           (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |        
           (('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION' 
           IN TYPEOF(pdr.used_representation)) AND 
          (pdr.used_representation.name = 'second face shape')) )) = 1)) )) 
           = 0));
      wr8: (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(SELF,
           'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' + 
           'RELATED_SHAPE_ASPECT') | 
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'FEATURE_COMPONENT_RELATIONSHIP') 
           IN TYPEOF(sar)) ) | 
           ('FEATURE_BASED_PROCESS_PLANNING.CHAMFER' 
           IN TYPEOF(sdr.relating_shape_aspect)) )) = 1);
  END_ENTITY; -- chamfer_offset
  ENTITY circular_closed_profile
    SUBTYPE OF (shape_aspect);
    WHERE
      wr1: ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
           IN TYPEOF(SELF.of_shape.definition));
      wr2: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
           IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0);
      wr3: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | ((
           'FEATURE_BASED_PROCESS_PLANNING.'+
           'SHAPE_REPRESENTATION_WITH_PARAMETERS')
           IN TYPEOF(pdr.used_representation)) ) | 
           (NOT (SIZEOF(impl_rep.used_representation.items) = 2)) )) 
           = 0)) )) = 0);
      wr4: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
           IN TYPEOF(pdr.used_representation)) ) | 
           NOT(SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
           (('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' 
           IN TYPEOF(it)) 
           AND (it.name = 'orientation')) )) = 1) )) = 0)) )) = 0);
      wr5: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
           IN TYPEOF(pdr.used_representation)) ) | 
           (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
           ((SIZEOF([
           'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
           'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
           TYPEOF(it)) = 2) AND (it.name = 'diameter')) )) = 1)) )) 
           =  0)) )) = 0);
  END_ENTITY; -- circular_closed_profile
  ENTITY circular_pattern
    SUBTYPE OF (replicate_feature);
    WHERE
      wr1: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
          ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
          IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN
          (pds,'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
          ((SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
          'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' 
          + 'RELATING_SHAPE_ASPECT') | 
        ((('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP') 
          IN TYPEOF(sar))) ) | 
          ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT' 
          IN TYPEOF(sdr.related_shape_aspect)) )) = 1)) )) <= 3)) )) = 0);
      wr2: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
           IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0);
      wr3: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
           ('FEATURE_BASED_PROCESS_PLANNING.'+
           'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
           IN TYPEOF(pdr.used_representation)) ) | 
           (NOT ((SIZEOF (impl_rep.used_representation.items) >= 3)  
           AND (SIZEOF(impl_rep.used_representation.items) <= 5))) )) 
           = 0)) )) = 0);
     wr4:  (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
           ('FEATURE_BASED_PROCESS_PLANNING.'+
           'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
           IN TYPEOF(pdr.used_representation)) ) | 
           (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
           ((SIZEOF(
           ['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
           'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
           TYPEOF(it)) = 2) AND (it.name = 'diameter')) )) <= 1)) )) 
           = 0)) )) = 0);
      wr5: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
           ('FEATURE_BASED_PROCESS_PLANNING.'+
           'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
           IN TYPEOF(pdr.used_representation)) ) | 
           (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
           ((SIZEOF(
           ['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
          'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] * 
           TYPEOF(it)) = 2) AND (it.name = 'base feature rotation')) )) 
           <= 1)) )) = 0)) )) = 0);
      wr6: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
           ('FEATURE_BASED_PROCESS_PLANNING.'+
           'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
           IN TYPEOF(pdr.used_representation)) ) | 
           (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
           (('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' 
           IN TYPEOF(it)) AND 
           ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' 
           IN TYPEOF(it\measure_with_unit.value_component)) AND 
           (it.name = 'number of features')) )) = 1)) )) = 0)) )) = 0);
      wr7: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
           ('FEATURE_BASED_PROCESS_PLANNING.'+
           'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
           IN TYPEOF(pdr.used_representation)) ) | 
           (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
           ((SIZEOF(
           ['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
          'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] * 
           TYPEOF(it)) = 2) AND (it.name = 'angular spacing'))))= 1)) )) 
           = 0)) )) = 0);
      wr8: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
           ('FEATURE_BASED_PROCESS_PLANNING.'+
           'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
           IN TYPEOF(pdr.used_representation)) ) | 
           (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
           (('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' 
           IN TYPEOF(it)) AND (it.name = 'orientation')) )) = 1)) )) 
           = 0)) )) = 0);
  END_ENTITY; -- circular_pattern
  ENTITY closed_path_profile
    SUBTYPE OF (shape_aspect);
    WHERE
      wr1: ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
           IN TYPEOF(SELF.of_shape.definition));
      wr2: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
           'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' + 
           'DEFINITION') | 
           (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
           IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0);
      wr3: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
           IN TYPEOF(pdr.used_representation)) ) | 
           (NOT (SIZEOF(impl_rep.used_representation.items) = 1)) )) 
           = 0)) )) = 0);
      wr4: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.' + 
           'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
           IN TYPEOF(pdr.used_representation)) ) | 
           (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
           (('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' 
           IN TYPEOF(it)) AND (it.name = 'orientation')) )) = 1)) )) 
           = 0)) )) = 0);
      wr5: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
           'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' + 
           'DEFINITION') | 
           (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
           'FEATURE_BASED_PROCESS_PLANNING.' + 
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
           (('FEATURE_BASED_PROCESS_PLANNING.PATH_SHAPE_REPRESENTATION') 
           IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0);
  END_ENTITY; -- closed_path_profile
  ENTITY composite_hole
    SUBTYPE OF (compound_feature);
    WHERE
      wr1: (SELF\characterized_object.description IN ['counterbore',
               'countersunk']);
      wr2:  (SIZEOF (QUERY (pds <* USEDIN (SELF,
          'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION')|
           ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
           IN TYPEOF (pds)) AND 
           (SIZEOF (QUERY (csa <* USEDIN (pds, 
           'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE')| 
           ('FEATURE_BASED_PROCESS_PLANNING.COMPOSITE_SHAPE_ASPECT' 
           IN TYPEOF (csa)) AND 
           (SIZEOF (QUERY (sar <*  csa.component_relationships |
         ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
           IN TYPEOF(sar)) AND
           ('FEATURE_BASED_PROCESS_PLANNING.ROUND_HOLE' 
           IN TYPEOF (sar.related_shape_aspect))  )) = 2)  )) = 1) )) = 1); 
 
      WR3: (NOT (SELF\characterized_object.description = 'countersunk')) OR
           (SIZEOF (QUERY (pds <* USEDIN (SELF,
          'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION')|
           ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
           IN TYPEOF (pds)) AND 
           (SIZEOF (QUERY (csa <* USEDIN (pds, 
           'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE')| 
           ('FEATURE_BASED_PROCESS_PLANNING.COMPOSITE_SHAPE_ASPECT' 
           IN TYPEOF (csa)) AND 
           (SIZEOF (QUERY (sar <*  csa.component_relationships |
           ('FEATURE_BASED_PROCESS_PLANNING.ROUND_HOLE' 
           IN TYPEOF (sar.related_shape_aspect)) 
           AND
           NOT(SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN
           (sar.related_shape_aspect,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
           ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE'  
           IN TYPEOF(pd)) ) | 
           (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
           'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
           ((sa_occ.description = 'change in diameter occurrence')  AND 
           (SIZEOF(QUERY ( fcr2 <* QUERY ( sar2 <* USEDIN(sa_occ,
           'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' + 
           'RELATING_SHAPE_ASPECT') | 
           ((sar2.description = 'taper usage') AND 
         (('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP') 
           IN TYPEOF(sar2))) ) | 
           ('FEATURE_BASED_PROCESS_PLANNING.TAPER' 
           IN TYPEOF(fcr2.related_shape_aspect)) )) = 1)) )) = 0)) )) = 0) 
           )) = 1)  )) = 1) )) = 1); 
  END_ENTITY; -- composite_hole
  ENTITY compound_feature
    SUBTYPE OF (feature_definition);
      WHERE 
WR1:  SIZEOF( QUERY( pds <* USEDIN( SELF, 
      'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
      ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
      IN TYPEOF(pds))  AND
     (SIZEOF( QUERY( csa <* USEDIN( pds, 
     'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
     ((csa.name='compound feature in solid') AND
     ('FEATURE_BASED_PROCESS_PLANNING.COMPOSITE_SHAPE_ASPECT' 
     IN TYPEOF(csa))) )) = 1)  )) = 1;
WR2:  SIZEOF( QUERY( pds <* USEDIN( SELF, 
      'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
      ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
      IN TYPEOF(pds))  AND
     (SIZEOF( QUERY( csa <* USEDIN( pds, 
     'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
     'FEATURE_BASED_PROCESS_PLANNING.COMPOSITE_SHAPE_ASPECT' 
     IN TYPEOF(csa) )) = 1)  )) = 1; 
wr3: (SIZEOF(QUERY ( pds <* USEDIN(SELF,
     'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
     (('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
     IN TYPEOF(pds)) AND (SIZEOF(QUERY ( csa <* USEDIN(pds,
     'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
     (('FEATURE_BASED_PROCESS_PLANNING.COMPOSITE_SHAPE_ASPECT' 
     IN TYPEOF(csa)) AND 
     (SIZEOF(QUERY ( fcr <* csa.component_relationships | 
     (NOT ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
     IN TYPEOF(fcr))) )) = 0)) )) = 1)) )) = 1);
                
WR4: SIZEOF (QUERY (pds <* USEDIN (SELF,
     'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION')|
     ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
     IN TYPEOF (pds)) AND 
     (SIZEOF (QUERY (csa <* USEDIN (pds, 
     'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE')| 
     ('FEATURE_BASED_PROCESS_PLANNING.COMPOSITE_SHAPE_ASPECT' 
     IN TYPEOF (csa)) AND 
     (SIZEOF (QUERY (sar <*  csa.component_relationships |
     (SIZEOF ([
     'FEATURE_BASED_PROCESS_PLANNING.INSTANCED_FEATURE', 
     'FEATURE_BASED_PROCESS_PLANNING.TRANSITION_FEATURE', 
     'FEATURE_BASED_PROCESS_PLANNING.APPLIED_AREA'] *
     TYPEOF (sar.related_shape_aspect)) = 1) )) = 2)  )) = 1) )) = 1; 
               
wr5: (SIZEOF(QUERY ( pds <* USEDIN(SELF,
      'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
      (('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
      IN TYPEOF(pds)) AND 
      (SIZEOF(QUERY ( csa <* USEDIN(pds,
      'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
      (('FEATURE_BASED_PROCESS_PLANNING.COMPOSITE_SHAPE_ASPECT' 
      IN TYPEOF(csa)) AND 
      (SIZEOF(QUERY ( sar <* csa.component_relationships | 
      ('FEATURE_BASED_PROCESS_PLANNING.THREAD' 
      IN TYPEOF(sar.related_shape_aspect)) )) = 0)
      ) )) = 1)) )) = 1);
               
WR6: (SIZEOF (QUERY (pds <* USEDIN (SELF,
     'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION')|
     ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
     IN TYPEOF (pds)) AND   (SIZEOF (QUERY (csa <* USEDIN (pds, 
     'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE')|
     ('FEATURE_BASED_PROCESS_PLANNING.COMPOSITE_SHAPE_ASPECT' 
     IN TYPEOF (csa))  AND 
     (SIZEOF (QUERY (sar <*  csa.component_relationships |
     (('FEATURE_BASED_PROCESS_PLANNING.COMPOUND_FEATURE' 
     IN TYPEOF (sar.related_shape_aspect))  AND
     (sar.related_shape_aspect\characterized_object.name <> 
     SELF\characterized_object.name)) )) = 0)  )) = 1) )) = 1); 
END_ENTITY;  -- compound_feature
  ENTITY cylindrical_shape_representation
    SUBTYPE OF (shape_representation_with_parameters);
    WHERE
      wr1: (SIZEOF(SELF.items) = 3);
      wr2: (SIZEOF(QUERY ( it <* SELF.items | ((
           'FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' 
           IN TYPEOF(it)) AND (it.name = 'orientation')) )) = 1);
      wr3: (SIZEOF(QUERY ( it <* SELF.items | ((SIZEOF([
           'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
           'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
            TYPEOF(it)) = 2) AND (it.name = 'length')) )) = 1);
      wr4: (SIZEOF(QUERY ( it <* SELF.items | ((SIZEOF([
           'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
           'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
            TYPEOF(it)) = 2) AND (it.name = 'diameter')) )) = 1);
  END_ENTITY; -- cylindrical_shape_representation
  ENTITY directed_dimensional_location
    SUBTYPE OF (dimensional_location);
  END_ENTITY; -- directed_dimensional_location
  ENTITY direction_shape_representation
    SUBTYPE OF (shape_representation);
    WHERE
      wr1: (SIZEOF(SELF.items) = 1);
      wr2: (SIZEOF(QUERY ( it <* SELF.items | 
           (NOT (
           'FEATURE_BASED_PROCESS_PLANNING.DIRECTION' IN TYPEOF(it))) )) 
           = 0);
  END_ENTITY; -- direction_shape_representation
ENTITY document_file
   SUBTYPE OF (characterized_object, document);
   WHERE
 wr1: (SIZEOF(QUERY(adr<* QUERY(dr <* USEDIN(SELF,
   'FEATURE_BASED_PROCESS_PLANNING.DOCUMENT_REFERENCE.ASSIGNED_DOCUMENT') |
      'FEATURE_BASED_PROCESS_PLANNING.APPLIED_DOCUMENT_REFERENCE'
      IN TYPEOF(dr))|
     'FEATURE_BASED_PROCESS_PLANNING.EXTERNALLY_DEFINED_FEATURE_DEFINITION'
      IN TYPEOF(adr.items)
      ))=1) OR 
      (SIZEOF(QUERY (duc <* USEDIN(SELF,
      'FEATURE_BASED_PROCESS_PLANNING.DOCUMENT_USAGE_CONSTRAINT.SOURCE') |
      NOT 
      (SIZEOF(QUERY(aduc<* QUERY(duca <* USEDIN(duc,
    'FEATURE_BASED_PROCESS_PLANNING.DOCUMENT_USAGE_CONSTRAINT_ASSIGNMENT.'+
      'ASSIGNED_DOCUMENT_USAGE') |
      'FEATURE_BASED_PROCESS_PLANNING.'+
      'APPLIED_DOCUMENT_USAGE_CONSTRAINT_ASSIGNMENT'
      IN TYPEOF(duca))|
     'FEATURE_BASED_PROCESS_PLANNING.EXTERNALLY_DEFINED_FEATURE_DEFINITION'
      IN TYPEOF(aduc.items)
      ))=1))) = 0);
            
 wr2: (SIZEOF(QUERY(drt <* USEDIN(SELF,
      'FEATURE_BASED_PROCESS_PLANNING.'+
      'DOCUMENT_REPRESENTATION_TYPE.REPRESENTED_DOCUMENT') |
      (drt.name='physical')))=1);
  END_ENTITY; -- document_file
ENTITY edge_round
  SUBTYPE OF (transition_feature);
WHERE
  WR1: (NOT (SELF\shape_aspect.description = 'constant radius')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <*  USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
      'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS' 
       IN TYPEOF (pdr.used_representation))) = 1))) = 0);
  WR2: (NOT (SELF\shape_aspect.description = 'constant radius')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
      'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       (NOT (SIZEOF (impl_rep.used_representation.items) >= 1)
       AND  (SIZEOF (impl_rep.used_representation.items) <= 3)))) 
       = 0))) = 0); 
  WR3: (NOT (SELF.description = 'constant radius')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
      'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'radius'))) = 1))) = 0))) = 0);
  WR4: (NOT (SELF.description = 'constant radius')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
      'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'first offset'))) <= 1))) 
       = 0))) = 0);
  WR5: (NOT (SELF.description = 'constant radius')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
      'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'second offset'))) <= 1))) 
       = 0))) = 0);
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation)) AND 
       (pdr.used_representation.name = 'edge round face'))) = 1))) = 0; 
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation)) AND 
       (pdr.used_representation.name = 'first face shape'))) = 1))) = 0;
  WR8: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation)) AND 
       (pdr.used_representation.name = 'second face shape'))) = 1))) = 0;
END_ENTITY; -- edge_round
  ENTITY externally_defined_feature_definition
    SUBTYPE OF (feature_definition, externally_defined_item);
    WHERE
   wr1: (((SELF\characterized_object.description = 'thread') AND 
        (SELF\externally_defined_item.item_id='external thread') AND 
        (SELF\externally_defined_item.source.source_id=
              'external feature specification') ) OR 
        ((SELF\characterized_object.description = 'marking') AND 
        (SELF\externally_defined_item.item_id='external marking') AND 
        (SELF\externally_defined_item.source.source_id=
             'external feature specification')) OR 
        ((SELF\characterized_object.description = 'knurl') AND 
        (SELF\externally_defined_item.item_id='external knurl') AND  
        (SELF\externally_defined_item.source.source_id=
             'external feature specification')));
      WR2: ((NOT (SELF\characterized_object.description = 'thread')) OR 
           (SIZEOF( QUERY( pd <* USEDIN( SELF, 
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
           SIZEOF( QUERY( pdr <* USEDIN( pd, 
           'FEATURE_BASED_PROCESS_PLANNING.' +
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
           ('FEATURE_BASED_PROCESS_PLANNING.'+
           'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
           IN TYPEOF(pdr.used_representation)) AND
           ({8 <= SIZEOF(pdr.used_representation.items) <= 10} ) )) 
           = 1  )) = 1));
      WR3: ((NOT (SELF\characterized_object.description = 'marking')) OR 
           (SIZEOF( QUERY( pd <* USEDIN( SELF, 
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
           SIZEOF( QUERY( pdr <* USEDIN( pd, 
           'FEATURE_BASED_PROCESS_PLANNING.' +
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
           ('FEATURE_BASED_PROCESS_PLANNING.'+
           'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
           IN TYPEOF(pdr.used_representation)) AND
           (SIZEOF(pdr.used_representation.items) = 2)  )) = 1  )) = 1));
     WR4: ((NOT (SELF\characterized_object.description = 'knurl')) OR 
          (SIZEOF( QUERY( pd <* USEDIN( SELF, 
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
          SIZEOF( QUERY( pdr <* USEDIN( pd, 
          'FEATURE_BASED_PROCESS_PLANNING.' +
          'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
          ('FEATURE_BASED_PROCESS_PLANNING.'+
          'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
          IN TYPEOF(pdr.used_representation)) AND
          (SIZEOF(pdr.used_representation.items) = 1)   )) = 1  )) = 1));
    wr5:  (NOT (SELF\characterized_object.description IN [ 'knurl',
          'thread'])) OR
          (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
          ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
          IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN
          (pds,'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
          ((sa_occ.description = 'partial area occurrence') AND 
          (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
          'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' 
          + 'RELATED_SHAPE_ASPECT') | 
          ((sar.description = 'applied area usage') AND 
          (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
          IN TYPEOF(sar))) ) | 
          ('FEATURE_BASED_PROCESS_PLANNING.APPLIED_AREA' 
          IN TYPEOF(sdr.relating_shape_aspect)) )) = 1)) )) <= 1)) )) = 0);
 
  wr6: (NOT (SIZEOF(QUERY( doc <*(QUERY( adr <*USEDIN(SELF,
     'FEATURE_BASED_PROCESS_PLANNING.APPLIED_DOCUMENT_REFERENCE.ITEMS') |
         'FEATURE_BASED_PROCESS_PLANNING.DOCUMENT'
          IN TYPEOF (adr.assigned_document) )) |
        'FEATURE_BASED_PROCESS_PLANNING.DOCUMENT_FILE' IN TYPEOF(doc) ))
          =1) OR 
          NOT (SIZEOF(QUERY( doc <*(QUERY( aduc <*USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.'+
         'APPLIED_DOCUMENT_USAGE_CONSTRAINT_ASSIGNMENT.ITEMS') |
         'FEATURE_BASED_PROCESS_PLANNING.DOCUMENT'
          IN TYPEOF (aduc\
          document_usage_constraint_assignment.
          assigned_document_usage.source) )) |
        'FEATURE_BASED_PROCESS_PLANNING.DOCUMENT_FILE' IN TYPEOF(doc) ))
          >=1));
    wr7: ((NOT (SELF\characterized_object.description = 'marking')) OR 
         (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
         (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN
         (pd,'FEATURE_BASED_PROCESS_PLANNING.' + 
         'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
         (('FEATURE_BASED_PROCESS_PLANNING.'+
         'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
         IN TYPEOF(pdr.used_representation)) ) | 
         (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
         (('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' 
         IN TYPEOF(it)) AND (it.name = 'marking text')) )) = 1)) )) 
         = 0)) )) = 0));
  wr8: ((NOT (SELF\characterized_object.description = 'thread')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN
       (pd,'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
       (('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' 
       IN TYPEOF(it)) AND (it.name = 'removal direction') AND 
       ((it.description = 'internal') OR 
       (it.description = 'external'))) )) = 1)) )) = 0)) )) = 0));
 wr9: ((NOT (SELF\characterized_object.description = 'thread')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN
       (pd,'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
       (('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' 
       IN TYPEOF(it)) AND (it.name = 'qualifier')) ))<= 1)) ))= 0)) )) 
       = 0));
 wr10: ((NOT (SELF\characterized_object.description = 'thread')) OR 
       (SIZEOF(QUERY ( pd <*  USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN
       (pd,'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
       (('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' 
       IN TYPEOF(it)) AND (it.name = 'hand')) )) = 1)) )) = 0)) )) 
       = 0));
 wr11: ((NOT (SELF\characterized_object.description = 'thread')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN
       (pd,'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
       (('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' 
       IN TYPEOF(it)) AND (it.name = 'fit class')) )) = 1)) )) = 
       0)) )) = 0));
 wr12: ((NOT (SELF\characterized_object.description = 'thread')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN
       (pd,'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
       (('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' 
       IN TYPEOF(it)) AND (it.name = 'form')) )) = 1)) )) = 0)) )) 
       = 0));
 wr13: ((NOT (SELF\characterized_object.description = 'thread')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN
       (pd,'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'major diameter')) )) = 1)) )) 
       = 0)) )) = 0));
 wr14: ((NOT (SELF\characterized_object.description = 'thread')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN
       (pd,'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.RATIO_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'number of threads')) )) = 1)) )) 
       = 0)) )) = 0));
    wr15:  (NOT (SELF\characterized_object.description IN [ 'knurl',
          'thread'])) OR
          (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
          ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
          IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN
          (pds,'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
          ((SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
          'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' 
          + 'RELATED_SHAPE_ASPECT') | 
          ((sar.description = 'applied shape') AND 
          (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
          IN TYPEOF(sar))) ) | 
          ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT' 
          IN TYPEOF(sdr.relating_shape_aspect)) )) = 1)) )) <= 1)) )) = 0);  END_ENTITY; -- externally_defined_feature_definition
  ENTITY face_shape_representation
    SUBTYPE OF (shape_representation);
    WHERE
      wr1: (SIZEOF(SELF.items) >= 1);
      wr2: (SIZEOF(QUERY ( it <* SELF.items | (NOT (
        ('FEATURE_BASED_PROCESS_PLANNING.FACE_SURFACE' IN TYPEOF(it)) OR
        ('FEATURE_BASED_PROCESS_PLANNING.ORIENTED_FACE' IN TYPEOF(it)) ))
         )) = 0);
  END_ENTITY; -- face_shape_representation 
ENTITY face_shape_representation_relationship
  SUBTYPE OF (representation_relationship);
      WHERE
      wr1: ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION' 
            IN TYPEOF(SELF.rep_1));
      wr2: ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION' 
            IN TYPEOF(SELF.rep_2));
END_ENTITY; -- face_shape_representation_relationship
ENTITY feature_based_pp_action_assignment
  SUBTYPE OF (action_assignment);
  items : SET [1:?] OF feature_based_pp_action_item;
END_ENTITY;
ENTITY feature_based_pp_action_request_assignment
  SUBTYPE OF (action_request_assignment);
  items : SET [1:?] OF feature_based_pp_action_request_item;
END_ENTITY;
ENTITY feature_based_pp_approval_assignment
  SUBTYPE OF (approval_assignment);
  items : SET [1:?] OF feature_based_pp_approved_item;
END_ENTITY;
ENTITY feature_based_pp_date_assignment
  SUBTYPE OF (date_assignment);
  items : SET [1:?] OF feature_based_pp_dated_item;
END_ENTITY;
ENTITY feature_based_pp_organization_assignment
  SUBTYPE OF (organization_assignment);
  items : SET [1:?] OF feature_based_pp_organization_item;
END_ENTITY;
ENTITY feature_based_pp_person_and_organization_assignment
  SUBTYPE OF (person_and_organization_assignment);
  items : SET [1:?] OF feature_based_pp_person_and_organization_item;
END_ENTITY;
ENTITY feature_based_pp_security_classification_assignment
  SUBTYPE OF (security_classification_assignment);
  items : SET [1:?] OF feature_based_pp_classified_item;
END_ENTITY;
  ENTITY feature_component_definition
    SUBTYPE OF (characterized_object);
    WHERE
      wr1: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
         (NOT (SIZEOF(USEDIN(pd,
         'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE')) = 1)) )) 
         = 0);
  END_ENTITY; -- feature_component_definition
  ENTITY feature_component_relationship
    SUPERTYPE OF (ONEOF (pattern_omit_membership,pattern_offset_membership))
    SUBTYPE OF (shape_aspect_relationship);
    WHERE
      wr1: ((SIZEOF([
           'FEATURE_BASED_PROCESS_PLANNING.COMPOSITE_SHAPE_ASPECT',
           'FEATURE_BASED_PROCESS_PLANNING.REPLICATE_FEATURE',
           'FEATURE_BASED_PROCESS_PLANNING.TRANSITION_FEATURE',
           'FEATURE_BASED_PROCESS_PLANNING.MODIFIED_PATTERN'] * TYPEOF
           (SELF.relating_shape_aspect)) = 1) OR 
           ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_DEFINITION' 
           IN TYPEOF(SELF.relating_shape_aspect.of_shape.definition)) OR 
           ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
           IN TYPEOF(SELF.relating_shape_aspect.of_shape.definition)));
  END_ENTITY; -- feature_component_relationship
  ENTITY feature_definition
    SUBTYPE OF (characterized_object);
    WHERE
  wr1: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0);
 WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' 
       IN TYPEOF (it)) AND (it.name = 'orientation'))) = 1))) = 0))) = 0;
  WR3: SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.BOSS', 
       'FEATURE_BASED_PROCESS_PLANNING.TURNED_KNURL', 
       'FEATURE_BASED_PROCESS_PLANNING.THREAD', 
       'FEATURE_BASED_PROCESS_PLANNING.MARKING',            
       'FEATURE_BASED_PROCESS_PLANNING.RIB_TOP',          
       'FEATURE_BASED_PROCESS_PLANNING.ROUND_HOLE',
       'FEATURE_BASED_PROCESS_PLANNING.OUTSIDE_PROFILE', 
       'FEATURE_BASED_PROCESS_PLANNING.POCKET', 
       'FEATURE_BASED_PROCESS_PLANNING.REMOVAL_VOLUME', 
       'FEATURE_BASED_PROCESS_PLANNING.REVOLVED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.OUTER_ROUND', 
       'FEATURE_BASED_PROCESS_PLANNING.FLAT_FACE', 
       'FEATURE_BASED_PROCESS_PLANNING.PROTRUSION', 
       'FEATURE_BASED_PROCESS_PLANNING.ROUNDED_END', 
       'FEATURE_BASED_PROCESS_PLANNING.SLOT', 
       'FEATURE_BASED_PROCESS_PLANNING.SPHERICAL_CAP',
       'FEATURE_BASED_PROCESS_PLANNING.STEP', 
       'FEATURE_BASED_PROCESS_PLANNING.COMPOUND_FEATURE',
       'FEATURE_BASED_PROCESS_PLANNING.REPLICATE_FEATURE',
    'FEATURE_BASED_PROCESS_PLANNING.EXTERNALLY_DEFINED_FEATURE_DEFINITION']
       * TYPEOF (SELF)) = 1;
  
  WR4: (NOT (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.ROUND_HOLE', 
       'FEATURE_BASED_PROCESS_PLANNING.BOSS', 
       'FEATURE_BASED_PROCESS_PLANNING.OUTSIDE_PROFILE',           
       'FEATURE_BASED_PROCESS_PLANNING.REMOVAL_VOLUME',
       'FEATURE_BASED_PROCESS_PLANNING.FLAT_FACE',
       'FEATURE_BASED_PROCESS_PLANNING.POCKET',
       'FEATURE_BASED_PROCESS_PLANNING.PROTRUSION',
       'FEATURE_BASED_PROCESS_PLANNING.RIB_TOP',
       'FEATURE_BASED_PROCESS_PLANNING.ROUNDED_END',
       'FEATURE_BASED_PROCESS_PLANNING.SLOT',
       'FEATURE_BASED_PROCESS_PLANNING.STEP']
       * TYPEOF (SELF)) = 1)) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.PLANAR_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))AND
       (pdr.used_representation.name = 'maximum feature limit'))) = 1))) 
       <= 1);
  END_ENTITY; -- feature_definition
  ENTITY feature_pattern
    SUBTYPE OF (replicate_feature);
    WHERE
      WR1: SIZEOF( QUERY( pd <* USEDIN( SELF, 
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
           SIZEOF( QUERY( pdr <* USEDIN( pd, 
           'FEATURE_BASED_PROCESS_PLANNING.' +
           'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
           ('FEATURE_BASED_PROCESS_PLANNING.'+
           'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
           IN TYPEOF(pdr.used_representation)) AND
           (SIZEOF( QUERY( srwp_i <* pdr.used_representation.items |
           NOT ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' 
           IN TYPEOF(srwp_i)) )) > 0 ) ))   > 0  )) = 0;
 WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' 
       IN TYPEOF (it)) AND (it.name = 'base feature placement'))) > 1))) 
       = 0))) = 0;
  END_ENTITY; -- feature_pattern
  ENTITY fillet
    SUBTYPE OF (transition_feature);
  WHERE
    WR1: (NOT (SELF\shape_aspect.description = 'constant radius')) OR
         (SIZEOF (QUERY (pd <* USEDIN (SELF, 
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
         NOT (SIZEOF (QUERY (pdr <*  USEDIN (pd,
         'FEATURE_BASED_PROCESS_PLANNING.' +
         'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
         'FEATURE_BASED_PROCESS_PLANNING.'+
         'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
         IN TYPEOF (pdr.used_representation))) = 1))) = 0);
    WR2: (NOT (SELF\shape_aspect.description = 'constant radius')) OR
         (SIZEOF (QUERY (pd <* USEDIN (SELF, 
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
         NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
         'FEATURE_BASED_PROCESS_PLANNING.' +
         'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
         'FEATURE_BASED_PROCESS_PLANNING.'+
         'SHAPE_REPRESENTATION_WITH_PARAMETERS'
         IN TYPEOF (pdr.used_representation)) |
         (NOT (SIZEOF (impl_rep.used_representation.items) >= 1)
         AND(SIZEOF (impl_rep.used_representation.items) <= 3)))) 
         = 0))) = 0); 
    WR3: (NOT (SELF.description = 'constant radius')) OR
         (SIZEOF (QUERY (pd <* USEDIN (SELF, 
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
         NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
         'FEATURE_BASED_PROCESS_PLANNING.' +
         'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
         'FEATURE_BASED_PROCESS_PLANNING.'+
         'SHAPE_REPRESENTATION_WITH_PARAMETERS'
         IN TYPEOF (pdr.used_representation)) |
         NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
         (SIZEOF 
         (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
         'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
         TYPEOF (it)) = 2) AND (it.name = 'radius'))) = 1))) = 0))) = 0);
    WR4: (NOT (SELF.description = 'constant radius')) OR
         (SIZEOF (QUERY (pd <* USEDIN (SELF, 
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
         NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
         'FEATURE_BASED_PROCESS_PLANNING.' +
         'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
         'FEATURE_BASED_PROCESS_PLANNING.' +
         'SHAPE_REPRESENTATION_WITH_PARAMETERS'
         IN TYPEOF (pdr.used_representation)) |
         NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
         (SIZEOF 
         (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
         'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
         TYPEOF (it)) = 2) AND (it.name = 'first offset'))) <= 1))) 
         = 0))) = 0);
    WR5: (NOT (SELF.description = 'constant radius')) OR
         (SIZEOF (QUERY (pd <* USEDIN (SELF, 
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
         NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
         'FEATURE_BASED_PROCESS_PLANNING.' +
         'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
         'FEATURE_BASED_PROCESS_PLANNING.' +
         'SHAPE_REPRESENTATION_WITH_PARAMETERS'
         IN TYPEOF (pdr.used_representation)) |
         NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
         (SIZEOF 
         (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
         'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
         TYPEOF (it)) = 2) AND (it.name = 'second offset'))) <= 1))) 
         = 0))) = 0);
 
    WR6: SIZEOF (QUERY (pd <* USEDIN (SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
         'DEFINITION') |
         NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
         'FEATURE_BASED_PROCESS_PLANNING.' +
         'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
         ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
         IN TYPEOF (pdr.used_representation)) AND 
         (pdr.used_representation.name = 'fillet face'))) = 1))) = 0; 
    WR7: SIZEOF (QUERY (pd <* USEDIN (SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
         'DEFINITION') |
         NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
         'FEATURE_BASED_PROCESS_PLANNING.' +
         'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
         ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
         IN TYPEOF (pdr.used_representation)) AND 
         (pdr.used_representation.name = 'first face shape'))) = 1))) = 0; 
    WR8: SIZEOF (QUERY (pd <* USEDIN (SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
         'DEFINITION') |
         NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
         'FEATURE_BASED_PROCESS_PLANNING.' +
         'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
         ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
         IN TYPEOF (pdr.used_representation)) AND 
         (pdr.used_representation.name = 'second face shape'))) = 1))) = 0;  END_ENTITY;
  ENTITY flat_face
    SUBTYPE OF (feature_definition);
   WHERE
   wr1: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
        (('FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION' 
        IN TYPEOF(pdr.used_representation)) AND 
        (pdr.used_representation.name = 'removal direction')) )) = 1)) )) 
        = 0);
   wr2: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
        IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
        ((sa_occ.description = 'course of travel occurrence') AND 
        (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
        'RELATED_SHAPE_ASPECT') | 
        ((sar.description = 'path feature component usage') AND 
        (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
        IN TYPEOF(sar))) ) | 
        (('FEATURE_BASED_PROCESS_PLANNING.PATH_FEATURE_COMPONENT' 
        IN TYPEOF(sdr.relating_shape_aspect)) AND 
        (sdr.relating_shape_aspect.description = 'linear') AND 
        (sdr.name = 'course of travel')) )) = 1)) )) = 1)) )) = 0);
   wr3: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
        IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
        ((sa_occ.description = 'removal boundary occurrence') AND 
        (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
        'RELATED_SHAPE_ASPECT') | 
        ((sar.description = 'profile usage') AND 
        (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
        IN TYPEOF(sar))) ) | 
        (('FEATURE_BASED_PROCESS_PLANNING.LINEAR_PROFILE' 
        IN TYPEOF(sdr.relating_shape_aspect)) AND 
        (sdr.name = 'removal boundary')) )) = 1)) )) = 1)) )) = 0);
   WR4: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
        'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
        IN TYPEOF (pd)) | 
        NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
        (sa_occ.description = 'enclosed boundary occurrence') AND
        (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
        'RELATED_SHAPE_ASPECT') |
        (sar.description = 'profile usage') AND
        ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP' 
        IN TYPEOF (sar))) |
        (SIZEOF 
        (['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_CLOSED_PROFILE', 
        'FEATURE_BASED_PROCESS_PLANNING.NGON_CLOSED_PROFILE',
        'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_CLOSED_PROFILE',
        'FEATURE_BASED_PROCESS_PLANNING.CLOSED_PATH_PROFILE'] *
        TYPEOF (sdr.relating_shape_aspect)) = 1) AND
        (sdr.relating_shape_aspect.description = 'boundary'))) 
        = 1))) <= 1))) = 0;
  END_ENTITY; -- flat_face
  ENTITY hole_bottom
    SUBTYPE OF (shape_aspect);
   WHERE
   wr1: ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
        IN TYPEOF(SELF.of_shape.definition));
   wr2: (SELF.description IN ['through', 'flat', 'flat with radius',
        'flat with taper','spherical', 'conical']);
   wr3: ((NOT (SELF.description = 'through')) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION')) = 0)) )) 
         = 0));
  wr4 : ((NOT (SELF.description IN ['flat with radius', 
        'flat with taper', 'spherical','conical'])) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0));
  wr5: ((NOT (SELF.description = 'flat')) OR 
       (SIZEOF(QUERY ( pd <*  USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(impl_rep.used_representation.items) = 0)) )) 
        = 0)) )) = 0));
  wr6: ((NOT (SELF.description IN ['flat with radius','spherical'])) 
       OR (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(impl_rep.used_representation.items) = 1)) )) 
       = 0)) )) = 0));
  wr7: ((NOT (SELF.description = 'flat with taper')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(impl_rep.used_representation.items) = 2)) )) 
       = 0)) )) = 0));
  wr8: ((NOT (SELF.description = 'conical')) OR (SIZEOF(
       QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF (impl_rep.used_representation.items) >= 1)
       AND  (SIZEOF (impl_rep.used_representation.items) <= 2)) )) 
       = 0)) )) = 0));
  wr9: ((SELF.description = 'through') OR 
       (SIZEOF(QUERY ( fcr <* QUERY ( sar <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') | 
       ((sar.description = 'hole bottom usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
       IN TYPEOF(sar))) ) | 
       ((fcr.name IN ['hole depth start','hole depth end'])) )) >= 1));
 wr10: ((NOT (SELF.description = 'flat with radius')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF(it)) = 2) AND (it.name = 'corner radius')))) = 1)) )) 
       = 0)) )) = 0));
 wr11: ((NOT (SELF.description = 'spherical')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'radius')) )) = 1)) )) = 
       0)) )) = 0));
 wr12: ((NOT (SELF.description = 'conical')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'tip radius')) )) <= 1)) )) 
       = 0)) )) = 0));
 wr13: ((NOT (SELF.description = 'conical')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'tip angle')) )) = 1)) )) 
       = 0)) )) = 0));
 wr14: (SIZEOF(QUERY ( fcr <* QUERY ( sar <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') | 
       ((sar.description = 'hole bottom usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
       IN TYPEOF(sar))) ) | 
     ((fcr.related_shape_aspect.description ='bottom condition occurrence') 
       AND ('FEATURE_BASED_PROCESS_PLANNING.ROUND_HOLE' 
       IN TYPEOF(fcr.related_shape_aspect.of_shape.definition))) )) >= 1);
 WR15: ((NOT (SELF.description = 'flat with taper')) OR (SIZEOF(
       QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |  
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'final diameter')))) = 1)) )) 
       = 0)) )) = 0));
 wr16: ((NOT (SELF.description = 'flat with taper')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name =  'taper diameter')) )) = 1)) )) 
       = 0)) )) = 0));
   END_ENTITY; -- hole_bottom
ENTITY instanced_feature
  SUBTYPE OF (feature_definition, shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION' IN 
       TYPEOF (SELF.of_shape.definition);
  WR2: SELF.product_definitional;
END_ENTITY;
  ENTITY linear_profile
    SUBTYPE OF (shape_aspect);
    WHERE
  wr1: ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
       IN TYPEOF(SELF.of_shape.definition));
  wr2: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0);
  wr3: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(impl_rep.used_representation.items) = 2)) )) 
       = 0)) )) = 0);
  wr4: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       (('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF(it)) AND 
       (it.name = 'orientation')) )) = 1)) )) = 0)) )) = 0);
  wr5: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'profile length')) )) = 1)) )) 
       = 0)) )) = 0);
  END_ENTITY; -- linear_profile
  ENTITY location_shape_representation
    SUBTYPE OF (shape_representation);
    WHERE
 wr1: (SIZEOF(SELF.items) = 1);
 wr2: (SIZEOF(QUERY ( it <* SELF.items | 
      (NOT ('FEATURE_BASED_PROCESS_PLANNING.POINT' 
      IN TYPEOF(it))) )) = 0);
  END_ENTITY; -- location_shape_representation
  ENTITY marking
    SUBTYPE OF (feature_definition);
    WHERE
   WR1: SIZEOF( QUERY( pd <* USEDIN( SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       SIZEOF( QUERY( pdr <* USEDIN( pd, 
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.'+
       'SHAPE_REPRESENTATION_WITH_PARAMETERS' IN
       TYPEOF(pdr.used_representation)) AND
       ({2 <= SIZEOF(pdr.used_representation.items) <=6} ) )) 
       = 1 )) = 1;
  wr2: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* 
       QUERY ( pdr <* USEDIN(pd,'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
       (('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' 
       IN TYPEOF(it)) AND (it.name = 'marking text')) )) = 1)) )) 
       = 0)) )) = 0);
  wr3: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
       (('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' 
       IN TYPEOF(it)) AND (it.name = 'special instructions')) )) <= 1)) )) 
       = 0)) )) = 0);
  wr4: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd, 
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
       (('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' 
       IN TYPEOF(it)) AND (it.name = 'font name')))) <= 1)))) 
       = 0)) )) = 0);
  wr5: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'character height')) )) <= 1)) )) 
       = 0)) )) = 0);
  wr6: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'character spacing')) )) <= 1)) )) 
       = 0)) )) = 0);
  WR7: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | 
       (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' 
       + 'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'applied shape') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT' 
       IN TYPEOF(sdr.relating_shape_aspect)) )) = 1)) )) = 1)) )) = 0);
  END_ENTITY; -- marking
  ENTITY modified_pattern
    SUBTYPE OF (shape_aspect);
    WHERE
   WR1: SIZEOF( QUERY (fcr <* QUERY(sar <* USEDIN( SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') |
       'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
       IN TYPEOF (sar)) |
       (SIZEOF( 
       ['FEATURE_BASED_PROCESS_PLANNING.REPLICATE_FEATURE',
       'FEATURE_BASED_PROCESS_PLANNING.INSTANCED_FEATURE'] * 
       TYPEOF (fcr.related_shape_aspect.of_shape.definition)) >= 1)  AND
       (fcr.description = 'base shape')) ) = 1;
  wr2: SIZEOF( QUERY (fcr <* QUERY(sar <* USEDIN( SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') |
       'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
       IN TYPEOF (sar)) |
       (SIZEOF( 
       ['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN', 
       'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN'] * 
       TYPEOF(fcr.related_shape_aspect.of_shape.definition)) = 1) AND 
       (fcr.description = 'base pattern')) ) = 1;
  wr3: SIZEOF(QUERY ( sar <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') | 
       (SIZEOF(QUERY ( msar <* USEDIN(sar.related_shape_aspect,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
      (SIZEOF([
      'FEATURE_BASED_PROCESS_PLANNING.PATTERN_OFFSET_MEMBERSHIP',
      'FEATURE_BASED_PROCESS_PLANNING.PATTERN_OMIT_MEMBERSHIP'] * 
      TYPEOF(sar)) = 1) AND (sar.description='modified pattern') 
      AND (sar :<>: msar) )) >= 1) )) = 0;
  END_ENTITY; -- modified_pattern
ENTITY ngon_closed_profile
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
       IN TYPEOF (SELF.of_shape.definition);
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
      'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT ((SIZEOF (impl_rep.used_representation.items) >= 3)  
       AND (SIZEOF(impl_rep.used_representation.items) <= 4)))) = 0))) = 0;
  WR4:  SIZEOF( QUERY( pd <* USEDIN( SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       SIZEOF( QUERY( pdr <* USEDIN( pd, 
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.'+
       'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
       IN TYPEOF(pdr.used_representation)) AND
       (SIZEOF( QUERY( srwp_i <* pdr.used_representation.items |
       (srwp_i.name = 'orientation') OR
       (srwp_i.name = 'number of sides') OR
       (srwp_i.name = 'circumscribed diameter') OR
       (srwp_i.name = 'corner radius') OR
       (srwp_i.name = 'diameter across flats'))) 
       = SIZEOF(pdr.used_representation.items))  )) = 1 )) = 1;
 
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1))) = 0))) = 0;
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' 
       IN TYPEOF (it)) AND 
       ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' 
       IN TYPEOF (it\measure_with_unit.value_component)) AND 
       (it.name = 'number of sides'))) = 1))) = 0))) = 0;
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
        NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name IN ['circumscribed diameter','diameter across flats']) )) 
       = 1) )) = 0))) = 0;
  WR8: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'corner radius'))) <= 1))) = 0))) = 0;
END_ENTITY;
  ENTITY ngon_shape_representation
    SUBTYPE OF (shape_representation_with_parameters);
    WHERE
  wr1: (SIZEOF(SELF.items) = 5);
  wr2: (SIZEOF(QUERY ( it <* SELF.items | 
       (('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' 
       IN TYPEOF(it)) AND (it.name = 'orientation')) )) = 1);
  wr3: (SIZEOF(QUERY ( it <* SELF.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'length')) )) = 1);
  wr4: (SIZEOF(QUERY ( it <* SELF.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'corner radius')) )) = 1);
  wr5: SIZEOF (QUERY (it <* SELF.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND
     (it.name IN ['circumscribed diameter','diameter across flats']) ))= 1;
 
  wr6: (SIZEOF(QUERY ( it <* SELF.items |
       (('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' 
       IN TYPEOF(it)) AND 
       ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' 
       IN TYPEOF(it\measure_with_unit.value_component)) AND 
       (it.name = 'number of sides')) )) = 1);
  END_ENTITY; -- ngon_shape_representation
  ENTITY open_path_profile
    SUBTYPE OF (shape_aspect);
    WHERE
  wr1: ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
       IN TYPEOF(SELF.of_shape.definition));
  wr2: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0);
  wr3: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF (impl_rep.used_representation.items) = 1)) )) 
       = 0)) )) = 0);
  wr4: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       (('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' 
       IN TYPEOF(it)) AND 
       (it.name = 'orientation')) )) = 1)) )) = 0)) )) = 0);
  wr5: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PATH_SHAPE_REPRESENTATION' 
       IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0);
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.PLANAR_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))AND
       (pdr.used_representation.name = 'profile limit') )) <= 1))) = 0;
END_ENTITY;
  ENTITY ordered_part
    SUBTYPE OF (action_assignment, characterized_object);
      items : SET [1:?] OF feature_based_pp_ordered_item;
    WHERE
  wr1: (SIZEOF(USEDIN(SELF,
     'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION'))= 1);
  wr2: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION')) = 1)) )) 
       = 0);
  wr3: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (NOT (SIZEOF(items) = 1)) )) = 0)) )) = 0);
  wr4: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( it <* pdr.used_representation.items |
       (('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' 
       IN TYPEOF(it)) AND (it.name = 'quantity')) )) = 1)) )) 
       = 0)) )) = 0);
  END_ENTITY; -- ordered_part
  ENTITY outer_round
    SUBTYPE OF (feature_definition);
    WHERE
  WR1: ((NOT (SELF\characterized_object.description = 'outer diameter')) OR 
       (SIZEOF( QUERY( pd <* USEDIN( SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       SIZEOF( QUERY( pdr <* USEDIN( pd, 
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
     ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS' 
       IN TYPEOF(pdr.used_representation)) AND
       (SIZEOF (pdr.used_representation.items) = 3) )) = 1 )) = 1));
  WR2: ((NOT (SELF\characterized_object.description 
       = 'outer diameter to shoulder')) OR 
       (SIZEOF( QUERY( pd <* USEDIN( SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       SIZEOF( QUERY( pdr <* USEDIN( pd, 
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
     ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS' 
       IN TYPEOF(pdr.used_representation)) AND
       (SIZEOF (pdr.used_representation.items) = 2) )) = 1 )) = 1));
  wr3: (SELF\characterized_object.description IN 
       ['outer diameter', 'outer diameter to shoulder']);
  wr4: ((NOT (SELF\characterized_object.description = 'outer diameter')) OR 
       (SIZEOF( QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'length')) )) = 1)) ))
       = 0)) )) = 0));
  wr5: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'diameter')) )) = 1)) )) 
       = 0)) )) = 0);
  wr6: ((NOT (SELF\characterized_object.description 
       = 'outer diameter to shoulder')) OR (
       SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF(pd)) ) | 
       (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'v-shape boundary occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'profile usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       (('FEATURE_BASED_PROCESS_PLANNING.VEE_PROFILE' 
       IN TYPEOF(sdr.relating_shape_aspect)) AND 
       (sdr.relating_shape_aspect.description = 'v-shape')) )) = 1)) )) 
       = 1)) )) = 0));
  wr7: ((NOT (SELF\characterized_object.description = 'outer diameter')) OR 
       (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'reduced size occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'taper usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       (('FEATURE_BASED_PROCESS_PLANNING.TAPER' 
       IN TYPEOF(sdr.relating_shape_aspect)) AND 
       (sdr.name = 'reduced size')) ))  = 1)) ))
       <= 1)) )) = 0));
  END_ENTITY; -- outer_round
  ENTITY outside_profile
    SUBTYPE OF (feature_definition);
    WHERE
  WR1: SIZEOF( QUERY( pd <* USEDIN( SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       SIZEOF( QUERY( pdr <* USEDIN( pd, 
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
     ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS' 
       IN TYPEOF(pdr.used_representation)) AND
       (SIZEOF (pdr.used_representation.items) = 1) )) = 1 )) = 1;
  WR2: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description IN ['boundary occurrence',
       'non-planar boundary occurrence',
       'partial circular boundary occurrence',
       'closed circular boundary occurrence',
       'open rectangular boundary occurrence',
       'closed rectangular boundary occurrence']) )) =1)  ))=0;
  WR3: (NOT(SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'boundary occurrence') )) =1)  ))=0))  OR
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_CLOSED_PROFILE', 
       'FEATURE_BASED_PROCESS_PLANNING.NGON_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.CLOSED_PATH_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.SQUARE_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.PARTIAL_CIRCULAR_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.ROUNDED_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.LINEAR_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.VEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.TEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.OPEN_PATH_PROFILE'] *
       TYPEOF (sdr.relating_shape_aspect)) = 1) AND
       (sdr.relating_shape_aspect.description = 'outside boundary'))) 
       = 1))) = 1))) = 0);
WR4:   (NOT(SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description IN ['complex boundary occurrence',
       'partial circular boundary occurrence',
       'closed circular boundary occurrence',
       'open rectangular boundary occurrence',
       'closed rectangular boundary occurrence']) ))=1)   ))=0)) OR
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       NOT(SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile floor usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
       IN TYPEOF (sar))) |
       'FEATURE_BASED_PROCESS_PLANNING.PROFILE_FLOOR' 
       IN TYPEOF (sdr.relating_shape_aspect))) = 1))) = 0))) = 0);
 WR5:  (NOT(SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description IN ['outside boundary',
       'complex boundary occurrence',
       'partial circular boundary occurrence',
       'closed circular boundary occurrence',
       'open rectangular boundary occurrence',
       'closed rectangular boundary occurrence']) ))=1)   ))=0)) OR
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'path feature component usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.PATH_FEATURE_COMPONENT'] *
       TYPEOF (sdr.relating_shape_aspect)) = 1) AND
       (sdr.name = 'profile swept shape') AND
       (sdr.relating_shape_aspect.description='linear') ))  = 1))) 
       = 1))) = 0);
  WR6: (NOT(SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'complex boundary occurrence') )) 
       =1)  ))=0))  OR
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP' 
       IN TYPEOF (sar))) |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.NGON_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.CLOSED_PATH_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.SQUARE_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.PARTIAL_CIRCULAR_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.ROUNDED_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.VEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.TEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.LINEAR_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.OPEN_PATH_PROFILE'] *  
       TYPEOF (sdr.relating_shape_aspect)) =1))  ) 
       = 1)))= 1))) = 0);
  WR7: (NOT(SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'partial circular boundary occurrence') )) 
       =1)  ))=0))  OR
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP' 
       IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.PARTIAL_CIRCULAR_PROFILE' IN  
       TYPEOF (sdr.relating_shape_aspect)))) 
       = 1)))= 1))) = 0);
  WR8: (NOT(SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'closed circular boundary occurrence') )) 
       =1)  ))=0))  OR
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP' 
       IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_CLOSED_PROFILE' IN  
       TYPEOF (sdr.relating_shape_aspect)))) 
       = 1)))= 1))) = 0);
  WR9: (NOT(SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'open rectangular boundary occurrence') )) 
       =1)  ))=0))  OR
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP' 
       IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.SQUARE_U_PROFILE' IN  
       TYPEOF (sdr.relating_shape_aspect)))) 
       = 1)))= 1))) = 0);
  WR10: (NOT(SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'closed rectangular boundary occurrence') )) 
       =1)  ))=0))  OR
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP' 
       IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_CLOSED_PROFILE' IN  
       TYPEOF (sdr.relating_shape_aspect)) )) = 1)))
       = 1))) = 0);
 wr11:  (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description IN ['boundary occurrence',
       'complex boundary occurrence',
       'partial circular boundary occurrence',
       'closed circular boundary occurrence',
       'open rectangular boundary occurrence',
       'closed rectangular boundary occurrence']) )) =1)  ))=0) OR
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       (('FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION' 
       IN TYPEOF(pdr.used_representation)) AND 
       (pdr.used_representation.name = 'removal direction')) )) = 1)) )) 
       = 0);
  END_ENTITY; -- outside_profile
ENTITY partial_circular_profile
    SUBTYPE OF (shape_aspect);
    WHERE
  wr1: ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
       IN TYPEOF(SELF.of_shape.definition));
  wr2: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0);
  wr3: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF (impl_rep.used_representation.items) >= 3)) )) 
       = 0)) )) = 0);
  wr4: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       (('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' 
       IN TYPEOF(it)) AND (it.name = 'orientation')) )) = 1)) )) 
       = 0)) )) = 0);
  wr5: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'radius')))) = 1)) )) 
       = 0)) )) = 0);
  wr6: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'sweep angle')) )) = 1)) )) 
       = 0)) )) = 0);
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.PLANAR_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))AND
       (pdr.used_representation.name = 'profile limit'))) <= 1))) = 0;
  END_ENTITY; -- partial_circular_profile
  ENTITY path_feature_component
    SUBTYPE OF (shape_aspect);
    WHERE
  wr1: ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
       IN TYPEOF(SELF.of_shape.definition));
  wr2: (SELF.description IN ['partial circular','complete circular',
       'linear','complex']);
  wr3: ((NOT (SELF.description = 'complex')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0));
  wr4: ((SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       (('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' 
       IN TYPEOF(it)) AND (it.name = 'orientation')) )) = 1)) )) 
       = 0)) )) = 0));
  wr5: ((NOT (SELF.description = 'partial circular')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(impl_rep.used_representation.items) = 3)) )) 
       = 0)) )) = 0));
  wr6: ((NOT (SELF.description = 'partial circular')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'radius')) )) = 1)) )) 
       = 0)) )) = 0));
  wr7: ((NOT (SELF.description = 'partial circular')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'sweep angle')) )) = 1)) )) 
       = 0)) )) = 0));
  wr8: ((NOT (SELF.description = 'complete circular')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(impl_rep.used_representation.items) = 2)) )) 
       = 0)) )) = 0));
  wr9: ((NOT (SELF.description = 'complete circular')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'radius')) )) = 1)) )) 
       = 0)) )) = 0));
  wr10: ((NOT (SELF.description = 'linear')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN( pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(impl_rep.used_representation.items) = 2)) )) 
        = 0)) )) = 0));
 wr11: ((NOT (SELF.description = 'linear')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'distance')) )) = 1)) )) 
       = 0)) )) = 0));
 wr12: ((NOT (SELF.description = 'linear')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION' 
       IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0));
  wr13: ((NOT (SELF.description = 'complex')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.PATH_SHAPE_REPRESENTATION' 
       IN TYPEOF(pdr.used_representation)) AND 
       (pdr.used_representation.name = 'sweep path')AND                 
       (SIZEOF( QUERY( srwp_i <* pdr.used_representation.items |
       (srwp_i.name = 'profile shape') )) = 1)
       ) )) = 1)) )) = 0));
  END_ENTITY; -- path_feature_component
  ENTITY path_shape_representation
    SUBTYPE OF (shape_representation);
    WHERE
      wr1: (SIZEOF(SELF.items) >= 1);
      wr2: (SIZEOF(QUERY ( i <* SELF.items | (SIZEOF([
               'FEATURE_BASED_PROCESS_PLANNING.BOUNDED_CURVE',
               'FEATURE_BASED_PROCESS_PLANNING.EDGE_CURVE',
               'FEATURE_BASED_PROCESS_PLANNING.PATH'] * TYPEOF(i)) = 
               1) )) >= 1);
  END_ENTITY; -- path_shape_representation
  ENTITY pattern_offset_membership
    SUBTYPE OF (feature_component_relationship);
    WHERE
  wr1 : (SIZEOF(QUERY ( fcr <* QUERY ( sar <* USEDIN(
        SELF.relating_shape_aspect,
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' 
        + 'RELATING_SHAPE_ASPECT') | 
        (('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
        IN TYPEOF(sar)) AND (sar :<>: SELF)) ) | 
        ((SIZEOF (QUERY( pdr <*(QUERY(pd <* USEDIN
        (fcr.related_shape_aspect.of_shape,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
        'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
        IN TYPEOF(pd))) |
        SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN',
        'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN']
        * TYPEOF(pdr.definition))  =1 )) = 0 )) )) = 0);   
       
  wr2 : (SIZEOF(QUERY ( fcr <* QUERY ( sar <* USEDIN(
        SELF.related_shape_aspect,
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' + 
        'RELATED_SHAPE_ASPECT') |
        (('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
        IN TYPEOF(sar)) AND (sar :<>: SELF)) ) | 
       (fcr.description='modified pattern') AND
        ('FEATURE_BASED_PROCESS_PLANNING.MODIFIED_PATTERN' 
        IN TYPEOF(fcr.relating_shape_aspect)) )) >= 1);
                        
  wr3 : (SIZEOF(QUERY ( fcr <* QUERY ( sar <* USEDIN(
        SELF.related_shape_aspect,
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' + 
        'RELATED_SHAPE_ASPECT') |
        (('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
        IN TYPEOF(sar)) AND (sar :<>: SELF)) ) | 
        (('FEATURE_BASED_PROCESS_PLANNING.MODIFIED_PATTERN' 
        IN TYPEOF(fcr.relating_shape_aspect)) AND 
        (NOT (SIZEOF(QUERY ( modfcr <* QUERY ( modsar <* USEDIN(
        fcr.relating_shape_aspect,'FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT') | 
        ((SIZEOF(['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN',
        'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN'] * 
        TYPEOF(modsar.related_shape_aspect.of_shape.definition)) = 1) AND 
        (modsar :<>: fcr)) ) | 
        (NOT (modfcr.related_shape_aspect.of_shape.definition :=: 
        SELF.relating_shape_aspect.of_shape.definition)) )) 
         = 0))) )) = 0);
         
  wr4 : ((NOT ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN' 
        IN TYPEOF(SELF.relating_shape_aspect.of_shape.definition))) OR
        (SIZEOF(QUERY ( pd <* USEDIN(SELF.related_shape_aspect,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(USEDIN(pd,'FEATURE_BASED_PROCESS_PLANNING.' +
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION')) = 2)) )) = 0));
  wr5 : ((NOT ('FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN' 
        IN TYPEOF(SELF.relating_shape_aspect.of_shape.definition))) OR
        (SIZEOF(QUERY ( pd <* USEDIN(SELF.related_shape_aspect,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(USEDIN(pd,'FEATURE_BASED_PROCESS_PLANNING.' +
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION')) = 1)) )) = 0));
  wr6 : ((NOT ('FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN' 
        IN TYPEOF(SELF.relating_shape_aspect.of_shape.definition))) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF.related_shape_aspect,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (NOT (SIZEOF(pdr.used_representation.items) = 2)) )) = 0)) )) 
        = 0));
  wr7 : ((NOT ('FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN' 
        IN TYPEOF(SELF.relating_shape_aspect.of_shape.definition))) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF.related_shape_aspect,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
        (('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' 
        IN TYPEOF(it)) AND 
        ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' 
        IN TYPEOF(it\measure_with_unit.value_component)) AND 
        (it.name = 'index number')) )) = 1)) )) = 0)) )) = 0));
  wr8 : ((NOT ('FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN' 
        IN TYPEOF(SELF.relating_shape_aspect.of_shape.definition))) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF.related_shape_aspect,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
        (('FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT' 
        IN TYPEOF(it)) AND (it.name = 'offset')) )) = 1)) )) = 0)) )) 
        = 0));
  wr9:  ((NOT ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN' 
        IN TYPEOF(SELF.relating_shape_aspect.of_shape.definition))) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF.related_shape_aspect,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION')|
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(impl_rep.used_representation.items ) = 3)) )) 
        = 0)) )) = 0));
  wr10: ((NOT ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN' 
        IN TYPEOF(SELF.relating_shape_aspect.of_shape.definition))) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF.related_shape_aspect,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION')|
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
        (('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' 
        IN TYPEOF(it)) AND 
        ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' 
        IN TYPEOF(it\measure_with_unit.value_component)) AND 
        (it.name = 'row index')) )) = 1)) )) = 0)) )) = 0));
  wr11: ((NOT ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN' 
        IN TYPEOF(SELF.relating_shape_aspect.of_shape.definition))) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF.related_shape_aspect,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
        (('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' 
        IN TYPEOF(it)) AND 
        ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' 
        IN TYPEOF(it\measure_with_unit.value_component)) AND 
        (it.name = 'column index')) )) = 1)) )) = 0)) )) = 0));
  wr12: ((NOT ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN' 
        IN TYPEOF(SELF.relating_shape_aspect.of_shape.definition))) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF.related_shape_aspect,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
        (('FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT' 
        IN TYPEOF(it)) AND (it.name = 'offset distance')) )) = 1)) )) 
        = 0)) )) = 0));
  wr13: ((NOT ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN' 
        IN TYPEOF(SELF.relating_shape_aspect.of_shape.definition))) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF.related_shape_aspect,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
        (('FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION' 
        IN TYPEOF(pdr.used_representation)) AND 
        (pdr.used_representation.name = 'offset direction')) )) = 1)) )) 
        = 0));
  END_ENTITY; -- pattern_offset_membership 
  ENTITY pattern_omit_membership
    SUBTYPE OF (feature_component_relationship);
    WHERE
 wr1 : (SIZEOF(QUERY ( fcr <* QUERY ( sar <* USEDIN(
       SELF.relating_shape_aspect,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' 
       + 'RELATING_SHAPE_ASPECT') | 
       (('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
       IN TYPEOF(sar)) AND (sar :<>: SELF)) ) | 
       ((SIZEOF (QUERY( pdr <*(QUERY(pd <* USEDIN
       (fcr.related_shape_aspect.of_shape,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd))) |
       SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN',
       'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN']
       * TYPEOF(pdr.definition))  =1 )) = 0 )) )) = 0);   
  wr2: (SIZEOF(QUERY ( fcr <* QUERY ( sar <* USEDIN(
       SELF.related_shape_aspect,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
       IN TYPEOF(sar)) AND (sar :<>: SELF)) ) | 
       (fcr.description='modified pattern') AND
       ('FEATURE_BASED_PROCESS_PLANNING.MODIFIED_PATTERN' 
       IN TYPEOF(fcr.relating_shape_aspect)) )) >= 1);
  wr3: (SIZEOF(QUERY ( fcr <* QUERY ( sar <* USEDIN(
       SELF.related_shape_aspect,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
       IN TYPEOF(sar)) AND (sar :<>: SELF)) ) | 
       (('FEATURE_BASED_PROCESS_PLANNING.MODIFIED_PATTERN' 
       IN TYPEOF(fcr.relating_shape_aspect)) AND 
       (NOT (SIZEOF(QUERY ( modfcr <* QUERY ( modsar <* USEDIN(
       fcr.relating_shape_aspect,'FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT') | 
       ((SIZEOF(['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN',
       'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN'] * 
       TYPEOF(modsar.related_shape_aspect.of_shape.definition)) = 1) AND 
       (modsar :<>: fcr)) ) | 
       (NOT (modfcr.related_shape_aspect.of_shape.definition :=: 
       SELF.relating_shape_aspect.of_shape.definition)) ))
        = 0))) )) = 0);
  wr4: (SIZEOF(QUERY ( pd <* USEDIN(SELF.related_shape_aspect,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(USEDIN(pd,'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION')) = 1)) )) = 0);
  wr5: ((NOT ('FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN' 
       IN TYPEOF(SELF.relating_shape_aspect.of_shape.definition))) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF.related_shape_aspect,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (NOT (SIZEOF(pdr.used_representation.items) = 1)) )) = 0)) )) = 0));
  wr6: ((NOT ('FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN' 
       IN TYPEOF(SELF.relating_shape_aspect.of_shape.definition))) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF.related_shape_aspect,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
       (('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' 
       IN TYPEOF(it)) AND 
       ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' 
       IN TYPEOF(it\measure_with_unit.value_component)) AND 
       (it.name = 'index number')) )) = 1)) )) = 0)) )) = 0));
  wr7: ((NOT ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN' 
       IN TYPEOF(SELF.relating_shape_aspect.of_shape.definition))) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF.related_shape_aspect,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (NOT (SIZEOF(pdr.used_representation.items) = 2)) )) = 0)) )) = 0));
  wr8: ((NOT ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN' 
       IN TYPEOF(SELF.relating_shape_aspect.of_shape.definition))) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF.related_shape_aspect,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
       (('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' 
       IN TYPEOF(it)) AND ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' 
       IN TYPEOF(it\measure_with_unit.value_component)) AND 
       (it.name = 'row index')) )) = 1)) )) = 0)) )) = 0));
  wr9: ((NOT ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN' 
       IN TYPEOF(SELF.relating_shape_aspect.of_shape.definition))) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF.related_shape_aspect,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
       (('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' 
       IN TYPEOF(it)) AND ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' 
       IN TYPEOF(it\measure_with_unit.value_component)) AND 
       (it.name = 'column index')) )) = 1)) )) = 0)) )) = 0));
  END_ENTITY; -- pattern_omit_membership
  ENTITY placed_datum_target_feature
    SUBTYPE OF (datum_target);
    WHERE
  wr1 : (SELF.description IN ['point','line','rectangle','circle']);
  wr2 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0);
  wr3 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( dtm_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' +
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* dtm_rep.used_representation.items | 
        (('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' 
        IN TYPEOF(it)) AND (it.name = 'orientation')) )) = 1)) )) 
        = 0)) )) = 0);
  wr4 : ((NOT (SELF.description = 'point')) OR 
        (SIZEOF(QUERY ( pd <*  USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( dtm_rep <* 
        QUERY ( pdr <* USEDIN(pd,'FEATURE_BASED_PROCESS_PLANNING.' +
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(dtm_rep.used_representation.items) = 1)) )) 
        = 0)) )) = 0));
  wr5 : ((NOT (SELF.description IN ['line','circle'])) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( dtm_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' +
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(dtm_rep.used_representation.items) = 2)) )) 
         = 0)) )) = 0));
  wr6 : ((NOT (SELF.description = 'rectangle')) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( dtm_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' +
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(dtm_rep.used_representation.items) = 3)) )) 
        = 0)) )) = 0));
  wr7 : ((NOT (SELF.description = 'circle')) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( dtm_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* dtm_rep.used_representation.items | 
        ((SIZEOF([
        'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
        TYPEOF(it)) = 2) AND (it.name = 'target diameter')) )) 
        = 1)) )) = 0)) )) = 0));
  wr8 : ((NOT (SELF.description = 'line')) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( dtm_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* dtm_rep.used_representation.items | 
        ((SIZEOF([
        'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
        TYPEOF(it)) = 2) AND (it.name = 'target length')))) = 1)) )) 
        = 0)) )) = 0));
  wr9 : ((NOT (SELF.description = 'rectangle')) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( dtm_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* dtm_rep.used_representation.items | 
        ((SIZEOF([
        'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
        TYPEOF(it)) = 2) AND (it.name = 'target length')))) = 1)) )) 
        = 0)) )) = 0));
  wr10: ((NOT (SELF.description = 'rectangle')) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( dtm_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* dtm_rep.used_representation.items | 
        ((SIZEOF([
        'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
        TYPEOF(it)) = 2) AND (it.name = 'target width'))))= 1))))
        = 0)) ))=0));
  END_ENTITY; -- placed_datum_target_feature
ENTITY planar_shape_representation
  SUBTYPE OF (shape_representation);
WHERE
  WR1: SIZEOF (SELF.items) = 1;
  WR2: (SIZEOF (QUERY (it <* SELF.items |
       NOT ('FEATURE_BASED_PROCESS_PLANNING.PLANE' 
       IN TYPEOF (it)))) = 1) ;
END_ENTITY; 
  ENTITY pocket
    SUBTYPE OF (feature_definition);
    WHERE
  wr1: (SELF\characterized_object.description IN 
       ['closed rectangular','open rectangular', 'complex', 
       'circular cutout', 'complex cutout', 'recess']);
  wr2: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'pocket depth occurrence') AND
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'path feature component usage')  AND 
       (sar.name = 'pocket depth') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       (('FEATURE_BASED_PROCESS_PLANNING.PATH_FEATURE_COMPONENT' 
       IN TYPEOF(sdr.relating_shape_aspect)) AND 
       (sdr.relating_shape_aspect.description ='linear')) )) 
       = 1)) )) = 1)) )) = 0);
 WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
    WR4:  SIZEOF( QUERY( pd <* USEDIN( SELF, 
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
          SIZEOF( QUERY( pdr <* USEDIN( pd, 
         'FEATURE_BASED_PROCESS_PLANNING.' +
         'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
         ('FEATURE_BASED_PROCESS_PLANNING.'+
         'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
         IN TYPEOF(pdr.used_representation)) AND
        ({1 <= SIZEOF(pdr.used_representation.items) <= 2} ) )) = 1 )) = 1;
   WR5:  SIZEOF( QUERY( pd <* USEDIN( SELF, 
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
         SIZEOF( QUERY( pdr <* USEDIN( pd, 
         'FEATURE_BASED_PROCESS_PLANNING.' +
         'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
         ('FEATURE_BASED_PROCESS_PLANNING.'+
         'SHAPE_REPRESENTATION_WITH_PARAMETERS' IN
         TYPEOF(pdr.used_representation)) AND
         (SIZEOF( QUERY( srwp_i <* pdr.used_representation.items |
         (srwp_i.name = 'orientation') OR
         (srwp_i.name = 'fillet radius'))) 
         = SIZEOF(pdr.used_representation.items)) )) = 1 )) = 1;
   WR6: SIZEOF (QUERY (pd <* USEDIN (SELF, 
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
        NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
        'FEATURE_BASED_PROCESS_PLANNING.' +
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
        'FEATURE_BASED_PROCESS_PLANNING.' +
        'SHAPE_REPRESENTATION_WITH_PARAMETERS'
        IN TYPEOF (pdr.used_representation)) |
        NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
        (SIZEOF (
        ['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
        TYPEOF (it)) = 2) AND (it.name = 'fillet radius'))) <= 1))) 
        = 0))) = 0;
  wr7: ((NOT (SELF\characterized_object.description IN ['complex',
       'non-circular cutout','recess'])) OR 
       (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'boundary occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       ((sar.description = 'profile usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.NGON_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.CLOSED_PATH_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.SQUARE_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.PARTIAL_CIRCULAR_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.ROUNDED_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.VEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.TEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.OPEN_PATH_PROFILE'] * 
       TYPEOF(sdr.relating_shape_aspect)) = 1)) )) = 1)) )) 
       = 1)) )) = 0));
  wr8: ((NOT (SELF\characterized_object.description = 
       'closed rectangular')) 
       OR (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'closed boundary occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'profile usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       (('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_CLOSED_PROFILE' 
       IN TYPEOF(sdr.relating_shape_aspect))) )) = 1)) )) 
       = 1)) )) = 0));
  wr9: ((NOT (SELF\characterized_object.description = 'open rectangular')) 
       OR (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |  
       ((sa_occ.description = 'open boundary occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'profile usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       (('FEATURE_BASED_PROCESS_PLANNING.SQUARE_U_PROFILE' 
       IN TYPEOF(sdr.relating_shape_aspect))) )) = 1)) )) 
       = 1)) )) = 0));
  wr10: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'bottom condition occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'pocket bottom usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       ('FEATURE_BASED_PROCESS_PLANNING.POCKET_BOTTOM' 
       IN TYPEOF(sdr.relating_shape_aspect)) )) = 1)) )) = 1)) )) = 0);
 wr11: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'change in boundary occurrence') AND 
       (SIZEOF(QUERY ( fcr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') | 
       ((sar.description = 'taper usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       (('FEATURE_BASED_PROCESS_PLANNING.TAPER' 
       IN TYPEOF(fcr.related_shape_aspect)) AND 
       (fcr.related_shape_aspect.description 
       IN ['angle taper','directed taper'])) )) = 1)) )) 
       <= 1)) )) = 0);
 WR12: (NOT (SELF\characterized_object.description = 'circular cutout')) OR 
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'enclosed boundary occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP' 
       IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_CLOSED_PROFILE' 
       IN TYPEOF (sdr.relating_shape_aspect)))) 
       = 1))) = 1))) = 0);
 WR13: (NOT (SELF\characterized_object.description IN 
       ['circular cutout','complex cutout'])) OR 
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'bottom condition occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'pocket bottom usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
       IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.POCKET_BOTTOM' 
       IN TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.relating_shape_aspect.description = 'through'))) 
       = 1))) = 1))) = 0);
 WR14: (NOT (SELF\characterized_object.description = 'recess')) OR 
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'bottom condition occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'pocket bottom usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
       IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.POCKET_BOTTOM' 
       IN TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.relating_shape_aspect.description IN ['planar','complex']))) 
       = 1))) = 1))) = 0);
  END_ENTITY; -- pocket 
ENTITY pocket_bottom
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
       IN TYPEOF (SELF.of_shape.definition);
  WR2: SELF.description IN ['planar', 'complex', 'through'];
  wr3 : ((NOT (SELF.description = 'planar')) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION') 
        IN TYPEOF(pdr.used_representation))  AND 
        (pdr.used_representation.name = 'floor normal') )) = 1)) )) = 0));
  wr4 : ((NOT (SELF.description = 'planar')) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.LOCATION_SHAPE_REPRESENTATION') 
        IN TYPEOF(pdr.used_representation))  AND 
        (pdr.used_representation.name = 'floor location'))) = 1)) )) = 0));
 wr5 : ((NOT (SELF.description = 'complex')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION' 
       IN TYPEOF(pdr.used_representation)) AND 
       (pdr.used_representation.name = 'floor face') )) = 1)) )) = 0));
  WR6: (NOT (SELF.description IN  ['planar', 'complex']) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0));
  WR7: (NOT (SELF.description IN  ['planar', 'complex']) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) 
       <= 1) )) = 0))) = 0)); 
  WR8: (NOT (SELF.description = 'through') OR 
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 0))) = 0));
  WR9: (NOT (SELF.description IN ['planar', 'complex'])) OR 
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'radius'))) <= 1))) = 0))) = 0);
  WR10: SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') | 
       (sar.description = 'pocket bottom usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
       IN TYPEOF (sar))) |
     (fcr.related_shape_aspect.description = 'bottom condition occurrence') 
       AND
       ('FEATURE_BASED_PROCESS_PLANNING.POCKET' 
       IN TYPEOF(fcr.related_shape_aspect.of_shape.definition)))) >= 1;
 WR11: ((NOT (SELF.description IN ['planar','complex'])) OR
        (SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') | 
       (sar.description = 'pocket bottom usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
       IN TYPEOF (sar))) |
     (fcr.related_shape_aspect.description = 'bottom condition occurrence')
      AND
     (fcr.related_shape_aspect.name IN 
      ['pocket depth start', 'pocket depth end'])
      )) = 0));
END_ENTITY;  -- Pocket_bottom
ENTITY profile_floor
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
       IN TYPEOF (SELF.of_shape.definition);
  WR2: SELF.description IN ['planar', 'complex', 'through'];
  WR3: (NOT (SELF.description IN ['planar', 'complex']) OR 
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0));
  WR4: (NOT (SELF.description IN  ['planar', 'complex'])) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) >= 1)AND
      (SIZEOF (impl_rep.used_representation.items) <= 2))) = 0))) = 0); 
  WR5: (NOT (SELF.description = 'through') OR 
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 0))) = 0));
  WR6: (NOT (SELF.description IN ['planar', 'complex'])) OR 
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
    (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'radius'))) = 1))) = 0))) = 0);
  WR7: SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') | 
       (sar.description = 'profile floor usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN
       TYPEOF (sar))) |
       'FEATURE_BASED_PROCESS_PLANNING.OUTSIDE_PROFILE' IN TYPEOF
       (fcr.related_shape_aspect.of_shape.definition))) >= 1;
  WR8: ((NOT (SELF.description IN ['planar','complex'])) OR
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION')
       | (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | ((
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') IN TYPEOF(pdr.
       used_representation)) ) | (NOT (SIZEOF(QUERY ( it <* 
       impl_rep.used_representation.items | 
       (('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM'
       IN TYPEOF(it)) AND (it.name = 'shape profile floor orientation') 
       AND (it.description IN ['shape profile start','shape profile end']))
       )) =  1)) )) = 0)) )) = 0));
 WR9: (NOT (SELF.description = 'complex')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))  AND 
       (pdr.used_representation.name='floor'))) = 1))) = 1);
 WR10: (NOT (SELF.description = 'planar')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.PLANAR_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))  AND 
       (pdr.used_representation.name='floor'))) = 1))) = 1);
END_ENTITY;
  ENTITY protrusion
    SUBTYPE OF (feature_definition);
    WHERE
  wr1: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(impl_rep.used_representation.items) = 1)) )) 
       = 0)) )) = 0);
  wr2: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'shape volume occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'volume shape usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       (sdr.relating_shape_aspect.description = 'volume shape') )) = 1)) )) 
       = 1)) )) = 0);
  END_ENTITY; -- protrusion
ENTITY rectangular_closed_profile
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
       IN TYPEOF (SELF.of_shape.definition);
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT ((SIZEOF (impl_rep.used_representation.items) >= 3)  
       AND (SIZEOF(impl_rep.used_representation.items) <= 4)))) = 0))) = 0;
WR4:  SIZEOF( QUERY( pd <* USEDIN( SELF,'FEATURE_BASED_PROCESS_PLANNING.' +
      'PROPERTY_DEFINITION.DEFINITION') |
      SIZEOF( QUERY( pdr <* USEDIN( pd, 'FEATURE_BASED_PROCESS_PLANNING.' +
      'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
     ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS' 
      IN TYPEOF(pdr.used_representation)) AND
      (SIZEOF( QUERY( srwp_i <* pdr.used_representation.items |
      (srwp_i.name = 'orientation') OR
      (srwp_i.name = 'length') OR
      (srwp_i.name = 'width') OR
      (srwp_i.name = 'corner radius') )) =
      SIZEOF(pdr.used_representation.items))
       )) = 1 )) = 1;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1))) = 0))) = 0;
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'width'))) = 1))) = 0))) = 0;
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'length'))) = 1))) = 0))) = 0;
  WR8: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'corner radius'))) <= 1))) = 0))) = 0;
END_ENTITY;
  ENTITY rectangular_pattern
    SUBTYPE OF (replicate_feature);
    WHERE
      wr1: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
          ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
          IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN
          (pds,'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
          ((SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
          'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' 
          + 'RELATING_SHAPE_ASPECT') | 
        ((('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP') 
          IN TYPEOF(sar))) ) | 
          ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT' 
          IN TYPEOF(sdr.related_shape_aspect)) )) = 1)) )) <= 5)) )) = 0);
  wr2 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
        (('FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION' 
        IN TYPEOF(pdr.used_representation)) AND 
       (pdr.used_representation.name = 'row layout direction') ) )) 
       = 1)) ))  = 0);
  wr3 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION' 
        IN TYPEOF(pdr.used_representation)) AND 
        (pdr.used_representation.name = 'column layout direction')) )) 
        = 1)) )) = 0);
  wr4 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' + 
        'DEFINITION') | (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
        ('FEATURE_BASED_PROCESS_PLANNING.'+
        'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
        IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0);
  wr5 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
        ('FEATURE_BASED_PROCESS_PLANNING.'+
        'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(impl_rep.used_representation.items) = 5)) )) 
        = 0)) )) = 0);
  wr6 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
        ('FEATURE_BASED_PROCESS_PLANNING.'+
        'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
        (('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' 
        IN TYPEOF(it)) AND 
        ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' 
        IN TYPEOF(it\measure_with_unit.value_component)) AND 
        (it.name = 'number of rows')) )) = 1)) )) = 0)) )) = 0);
  wr7 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
        ('FEATURE_BASED_PROCESS_PLANNING.'+
        'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
        (('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' 
        IN TYPEOF(it)) AND 
        ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' 
        IN TYPEOF(it\measure_with_unit.value_component)) AND 
        (it.name = 'number of columns')) )) = 1)) )) = 0)) )) = 0);
  wr8 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN( pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
        ('FEATURE_BASED_PROCESS_PLANNING.'+
        'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
        ((SIZEOF([
        'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
        TYPEOF(it)) = 2) AND (it.name = 'row spacing')) )) = 1)) )) 
        = 0)) )) = 0);
  wr9: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
        ('FEATURE_BASED_PROCESS_PLANNING.'+
        'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
        ((SIZEOF([
        'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
        TYPEOF(it)) = 2) AND (it.name = 'column spacing'))))= 1)) )) 
        = 0)) )) = 0);
  wr10: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
        ('FEATURE_BASED_PROCESS_PLANNING.'+
        'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
        (('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF(it)) AND 
        (it.name = 'orientation')) )) = 1)) )) = 0)) )) = 0);
  END_ENTITY; -- rectangular_pattern
  ENTITY removal_volume
    SUBTYPE OF (feature_definition);
    WHERE
 
  wr1: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(impl_rep.used_representation.items) = 1)) )) 
       = 0)) )) = 0);
  wr2: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'shape volume occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' 
       + 'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'volume shape usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       (sdr.relating_shape_aspect.description = 'volume shape') )) = 1)) )) 
       = 1)) )) = 0);
  END_ENTITY; -- removal_volume
  ENTITY replicate_feature
    SUPERTYPE OF (ONEOF (circular_pattern, rectangular_pattern, 
      feature_pattern))
    SUBTYPE OF (feature_definition);
  WHERE
      wr1: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
           'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION')
                | (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
               'FEATURE_BASED_PROCESS_PLANNING.' + 
               'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | ((
               'FEATURE_BASED_PROCESS_PLANNING.' + 
               'SHAPE_REPRESENTATION_WITH_PARAMETERS') IN TYPEOF(pdr.
               used_representation)) ))  = 1)) )) = 0);
   wr2: (SIZEOF(QUERY ( fcr <* QUERY ( sar <* 
        USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' 
        + 'RELATING_SHAPE_ASPECT') | 
        ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
        IN TYPEOF(sar)) ) | 
        ((SIZEOF(['FEATURE_BASED_PROCESS_PLANNING.REPLICATE_FEATURE',
        'FEATURE_BASED_PROCESS_PLANNING.INSTANCED_FEATURE'] * 
        TYPEOF(fcr.related_shape_aspect)) >= 1) AND 
        (fcr.name = 'pattern basis')) )) = 1);
         
   wr3: ((SIZEOF(QUERY ( sar <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' 
        + 'RELATING_SHAPE_ASPECT') | 
        (NOT
        ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
        IN TYPEOF(sar))) )) + 
        SIZEOF(QUERY ( sar <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' 
        + 'RELATED_SHAPE_ASPECT') | 
        (NOT
        ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
        IN TYPEOF(sar))) ))) = 0);
END_ENTITY;  -- replicate_feature
  ENTITY revolved_profile
    SUBTYPE OF (feature_definition);
    WHERE
  wr1: (SELF\characterized_object.description IN 
       ['groove','flat','round','open profile']);
  wr2: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(impl_rep.used_representation.items) = 2)) )) 
       = 0)) )) = 0);
  WR3: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'radius')))) = 1)) )) 
       = 0)) )) = 0);
  wr4: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       (('FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION' 
       IN TYPEOF(pdr.used_representation)) AND 
       (pdr.used_representation.name = 'removal direction')) )) = 1)) )) 
       = 0);
  wr5: ((NOT (SELF\characterized_object.description = 'open profile')) OR
       (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'outer edge shape occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'profile usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       (('FEATURE_BASED_PROCESS_PLANNING.OPEN_PATH_PROFILE' 
       IN TYPEOF(sdr.relating_shape_aspect)) AND 
       (sdr.relating_shape_aspect.description = 'outer edge shape')) )) 
       = 1)) )) = 1)) )) = 0));
  wr6: (NOT (SELF\characterized_object.description = 'flat')) OR 
       (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION')|
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       (( sa_occ.description = 'flat edge shape occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'profile usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       (('FEATURE_BASED_PROCESS_PLANNING.LINEAR_PROFILE' 
       IN TYPEOF(sdr.relating_shape_aspect)) AND 
       (sdr.relating_shape_aspect.description = 'flat edge shape')) )) 
       = 1)) )) = 1)) )) = 0);
  wr7: ((NOT (SELF\characterized_object.description = 'round')) OR 
       (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'rounded edge shape occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'profile usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       (('FEATURE_BASED_PROCESS_PLANNING.PARTIAL_CIRCULAR_PROFILE' 
       IN TYPEOF(sdr.relating_shape_aspect)) AND 
       (sdr.relating_shape_aspect.description = 'rounded edge shape')) )) 
       = 1)) )) = 1)) )) = 0));
  wr8: ((NOT (SELF\characterized_object.description = 'groove')) OR 
       (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'sweep occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'profile usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       ((SIZEOF(['FEATURE_BASED_PROCESS_PLANNING.SQUARE_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.PARTIAL_CIRCULAR_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.ROUNDED_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.VEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.TEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.OPEN_PATH_PROFILE'] * 
       TYPEOF(sdr.relating_shape_aspect)) = 1) AND 
       (sdr.relating_shape_aspect.description = 'sweep')) )) = 1)) )) 
       = 1)) )) = 0));
  END_ENTITY; -- revolved_profile
ENTITY rib_top
   SUBTYPE OF (feature_definition);
  WHERE
  
  WR1: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'rib top condition occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'rib top usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
       IN TYPEOF (sar))) |
       'FEATURE_BASED_PROCESS_PLANNING.RIB_TOP_FLOOR' 
       IN TYPEOF (sdr.relating_shape_aspect))) = 1))) = 1))) = 0;
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))AND
       (pdr.used_representation.name = 'removal direction'))) = 1))) = 1;
END_ENTITY;
ENTITY rib_top_floor
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN
       TYPEOF (SELF.of_shape.definition);
  WR2: SELF.description IN ['planar', 'complex'];
  WR3: SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') | 
       (sar.description = 'rib top usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
       IN TYPEOF (sar))) |
    (fcr.related_shape_aspect.description = 'rib top condition occurrence') 
       AND
       ('FEATURE_BASED_PROCESS_PLANNING.RIB_TOP' IN TYPEOF
       (fcr.related_shape_aspect.of_shape.definition)))) >= 1;
  WR4: (NOT (SELF.description = 'complex')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))AND
       (pdr.used_representation.name = 'rib top face'))) = 1))) = 0);
  WR5: (NOT (SELF.description = 'planar')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.PLANAR_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))AND
       (pdr.used_representation.name = 'rib top face'))) = 1))) = 0);
  WR6: (NOT (SELF.description = 'planar')) OR
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'boundary occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP' 
       IN TYPEOF (sar))) |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_CLOSED_PROFILE', 
       'FEATURE_BASED_PROCESS_PLANNING.NGON_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.CLOSED_PATH_PROFILE'] *
       TYPEOF (sdr.relating_shape_aspect)) = 1) AND
       (sdr.relating_shape_aspect.description = 'rib top floor boundary'))) 
       = 1))) = 1))) = 0);
END_ENTITY;  -- rib_top_floor
  ENTITY round_hole
    SUBTYPE OF (feature_definition);
    WHERE
  wr1: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION')|
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'diameter occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'profile usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       (('FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_CLOSED_PROFILE' 
       IN TYPEOF(sdr.relating_shape_aspect)) AND 
       (sdr.name = 'diameter'))  )) = 1)) )) = 1)) )) = 0);
  wr2: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'hole depth occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'path feature component usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       (('FEATURE_BASED_PROCESS_PLANNING.PATH_FEATURE_COMPONENT' 
       IN TYPEOF(sdr.relating_shape_aspect)) AND 
       (sdr.name = 'hole depth') AND 
       (sdr.relating_shape_aspect.description = 'linear')) )) = 1)) )) 
       = 1)) )) = 0);
  wr3: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'bottom condition occurrence') AND 
       (SIZEOF(QUERY ( fcr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'hole bottom usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       ('FEATURE_BASED_PROCESS_PLANNING.HOLE_BOTTOM' 
       IN TYPEOF(fcr.relating_shape_aspect)) )) = 1)) )) = 1)) )) = 0);
  wr4: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'change in diameter occurrence') AND 
       (SIZEOF(QUERY ( fcr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'taper usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       ('FEATURE_BASED_PROCESS_PLANNING.TAPER' 
       IN TYPEOF(fcr.relating_shape_aspect)) )) = 1)) )) <= 1)) )) = 0);
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  END_ENTITY; -- round_hole
  ENTITY rounded_end
    SUBTYPE OF (feature_definition);
    WHERE
 
  wr1: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(impl_rep.used_representation.items) = 1)) )) 
       = 0)) )) = 0);
  wr2: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'partial circular boundary occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'profile usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       (('FEATURE_BASED_PROCESS_PLANNING.PARTIAL_CIRCULAR_PROFILE' 
       IN TYPEOF(sdr.relating_shape_aspect)) ) )) = 1)) )) = 1)) )) = 0);
  wr3: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'course of travel occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'path feature component usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       (('FEATURE_BASED_PROCESS_PLANNING.PATH_FEATURE_COMPONENT' 
       IN TYPEOF(sdr.relating_shape_aspect)) AND 
       (sdr.relating_shape_aspect.description = 'linear')) )) = 1)) )) 
       = 1)) )) = 0);
  END_ENTITY; -- rounded_end
  ENTITY rounded_u_profile
    SUBTYPE OF (shape_aspect);
    WHERE
  wr1: ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
       IN TYPEOF(SELF.of_shape.definition));
  wr2: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0);
  wr3: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF (impl_rep.used_representation.items) = 2)) )) 
       = 0)) )) = 0);
  WR4: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       (('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' 
       IN TYPEOF(it)) AND (it.name = 'orientation')) )) = 1)) )) 
       = 0)) )) = 0);
  wr5: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'width'))))= 1))))= 0))))= 0);
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.PLANAR_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))AND
       (pdr.used_representation.name = 'profile limit'))) <= 1))) = 0;
  END_ENTITY; -- rounded_u_profile
ENTITY shape_defining_relationship
  SUBTYPE OF (shape_aspect_relationship);
END_ENTITY;
  ENTITY shape_representation_with_parameters
    SUBTYPE OF (shape_representation);
    WHERE
  wr1: (SIZEOF(QUERY ( it <* SELF.items | 
       (NOT (SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.PLACEMENT',
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM'] *
       TYPEOF(it)) = 1)) )) = 0);
  END_ENTITY; -- shape_representation_with_parameters
  ENTITY slot
    SUBTYPE OF (feature_definition);
    WHERE
  wr1: (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) | 
       (NOT (SIZEOF (impl_rep.used_representation.items) = 1) ) )) 
       = 0))) = 0);
  wr2: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'swept shape occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'profile usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       ((SIZEOF(['FEATURE_BASED_PROCESS_PLANNING.SQUARE_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.PARTIAL_CIRCULAR_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.ROUNDED_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.VEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.TEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.OPEN_PATH_PROFILE'] * 
       TYPEOF(sdr.relating_shape_aspect)) = 1)) )) = 1)) )) 
       = 1)) )) = 0);
  wr3: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'course of travel occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'path feature component usage') AND 
       ((sar.name = 'course of travel') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) )) | 
       ('FEATURE_BASED_PROCESS_PLANNING.PATH_FEATURE_COMPONENT' 
       IN TYPEOF(sdr.relating_shape_aspect)) )) = 1)) )) = 1)) )) = 0);
  wr4: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'end condition occurrence') AND 
       (SIZEOF(QUERY ( fcr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'slot end usage') AND 
       (sar.name IN ['course of travel start','course of travel end']) AND 
       (('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       (('FEATURE_BASED_PROCESS_PLANNING.SLOT_END' 
       IN TYPEOF(fcr.relating_shape_aspect)) )  )) 
       = 1)) )) = 2)) )) = 0);
  END_ENTITY; -- slot  
  ENTITY slot_end
    SUBTYPE OF (shape_aspect);
    WHERE
  wr1 : ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
        IN TYPEOF(SELF.of_shape.definition));
  wr2 : (SELF.description IN ['open','radiused','flat','woodruff']);
  wr3 : ((NOT (SELF.description IN ['open','radiused'])) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) )) = 0)) )) = 0));
  wr4 : ((NOT (SELF.description IN ['flat','woodruff'])) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0));
  wr5 : ((NOT (SELF.description IN ['flat'])) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(impl_rep.used_representation.items) = 2)) )) 
         = 0)) )) = 0));
  wr6 : ((NOT (SELF.description = 'flat')) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
        ((SIZEOF([
        'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
        TYPEOF(it)) = 2) AND (it.name = 'first radius')) )) = 1)) )) 
        = 0)) )) = 0));
  wr7 : ((NOT (SELF.description = 'flat')) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
        ((SIZEOF([
        'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
        TYPEOF(it)) = 2) AND (it.name = 'second radius')))) = 1)) )) 
        = 0)) )) = 0));
  wr8 : ((NOT (SELF.description = 'woodruff')) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
        (('FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT' 
        IN TYPEOF(it)) AND (it.name = 'radius')) )) = 1)) )) 
        = 0)) )) = 0));
  wr9 : ((NOT (SELF.description IN ['woodruff'])) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(impl_rep.used_representation.items) = 1)) )) 
        = 0)) )) = 0));
  wr10: (SIZEOF(QUERY ( fcr <* QUERY ( sar <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
        'RELATING_SHAPE_ASPECT') | 
        ((sar.description = 'slot end usage') AND
        (sar.name IN ['course of travel start','course of travel end']) AND 
        ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' 
        IN TYPEOF(sar))) ) | 
        ((fcr.related_shape_aspect.description='end condition occurrence') 
        AND 
        ('FEATURE_BASED_PROCESS_PLANNING.SLOT' 
        IN TYPEOF(fcr.related_shape_aspect.of_shape.definition))) )) 
        >= 1);
  END_ENTITY; -- slot_end
  ENTITY spherical_cap
    SUBTYPE OF (feature_definition);
    WHERE
  
  wr1: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(impl_rep.used_representation.items) = 3)) )) 
       = 0)) )) = 0);
  wr2: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'radius')) )) = 1)))) 
       = 0)) )) = 0);
  wr3: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'internal angle')))) = 1)) )) 
       = 0)) )) = 0);
  END_ENTITY; -- spherical_cap
ENTITY square_u_profile
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
       IN TYPEOF (SELF.of_shape.definition);
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       (NOT (SIZEOF (impl_rep.used_representation.items) >= 4)
       AND  (SIZEOF (impl_rep.used_representation.items) <= 6)))) 
       = 0))) = 0; 
  WR4: SIZEOF( QUERY( pd <* USEDIN( SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
      SIZEOF( QUERY( pdr <* USEDIN( pd, 'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.'+
       'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
       IN TYPEOF(pdr.used_representation)) AND
       (SIZEOF( QUERY( srwp_i <* pdr.used_representation.items |
       (srwp_i.name = 'orientation') OR
       (srwp_i.name = 'width') OR
       (srwp_i.name = 'first angle') OR
       (srwp_i.name = 'second angle') OR
       (srwp_i.name = 'first radius') OR
       (srwp_i.name = 'second radius') OR
       (srwp_i.name = 'profile limit') )) 
        = SIZEOF(pdr.used_representation.items)) )) = 1 )) = 1;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1))) = 0))) = 0;
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'width'))) = 1))) = 0))) = 0;
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'first radius'))) <= 1))) = 0))) = 0;
  WR8: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'second radius'))) <= 1))) = 0))) = 0;
  WR9: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'first angle'))) = 1))) = 0))) = 0;
  WR10: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'second angle'))) = 1))) = 0))) = 0;
  WR11: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.PLANAR_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))AND
       (pdr.used_representation.name = 'profile limit'))) <= 1))) = 0;
END_ENTITY; -- Square_U_profile
  ENTITY step
    SUBTYPE OF (feature_definition);
    WHERE
  wr1: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(impl_rep.used_representation.items) = 1)) )) 
       = 0)) )) = 0);
   wr2: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'course of travel occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'path feature component usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       (('FEATURE_BASED_PROCESS_PLANNING.PATH_FEATURE_COMPONENT' 
       IN TYPEOF(sdr.relating_shape_aspect)) AND 
       (sdr.relating_shape_aspect.description = 'linear')) )) = 1)) )) 
       = 1)) )) = 0);
  wr3: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'removal boundary occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'profile usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       ('FEATURE_BASED_PROCESS_PLANNING.VEE_PROFILE' 
       IN TYPEOF(sdr.relating_shape_aspect)) )) = 1)) )) = 1)) )) = 0);
  END_ENTITY; -- step
  ENTITY taper
    SUBTYPE OF (shape_aspect);
    WHERE
  wr1: ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
       IN TYPEOF(SELF.of_shape.definition));
  wr2: (SELF.description IN ['angle taper','diameter taper',
       'directed taper']);
  wr3: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) )) = 1)) )) = 0);
  wr4: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(impl_rep.used_representation.items) = 1)) )) 
       = 0)) )) = 0);
  wr5: ((NOT (SELF.description = 'angle taper')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'taper angle')) )) = 1)) )) 
       = 0)) )) = 0));
  wr6: ((NOT (SELF.description = 'diameter taper')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'final diameter')) )) = 1)) )) 
       = 0)) )) = 0));
  wr7: ((NOT (SELF.description = 'directed taper')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *
       TYPEOF(it)) = 2) AND (it.name = 'angle')) )) = 1)) )) 
       = 0)) )) = 0));
     
 wr8: ((NOT (SELF.description = 'directed taper')) OR 
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION' 
       IN TYPEOF(pdr.used_representation)) AND 
       (pdr.used_representation.name = 'direction') )) 
       = 1)) )) = 0));
  END_ENTITY; -- taper
ENTITY tee_profile
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
       IN TYPEOF (SELF.of_shape.definition);
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       (NOT (SIZEOF (impl_rep.used_representation.items) >= 9)
       AND  (SIZEOF (impl_rep.used_representation.items) <= 10)))) 
       = 0))) = 0; 
WR4:  SIZEOF( QUERY( pd <* USEDIN( SELF, 
      'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
      SIZEOF( QUERY( pdr <* USEDIN( pd,
      'FEATURE_BASED_PROCESS_PLANNING.' +
      'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
      ('FEATURE_BASED_PROCESS_PLANNING.'+
      'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
      IN TYPEOF(pdr.used_representation)) AND
      (SIZEOF( QUERY( srwp_i <* pdr.used_representation.items |
      (srwp_i.name = 'orientation') OR
      (srwp_i.name = 'width') OR
      (srwp_i.name = 'depth') OR
      (srwp_i.name = 'cross bar width') OR
      (srwp_i.name = 'cross bar depth') OR
      (srwp_i.name = 'first offset') OR
      (srwp_i.name = 'second offset') OR
      (srwp_i.name = 'first angle') OR
      (srwp_i.name = 'second angle') OR
      (srwp_i.name = 'radius') )) 
      = SIZEOF(pdr.used_representation.items)) )) = 1 )) = 1;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1))) = 0))) = 0;
 
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND  (it.name = 'width'))) = 1))) = 0))) = 0;
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND (it.name = 'depth'))) = 1))) = 0))) = 0;
  WR8: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND (it.name = 'cross bar width'))) = 1))) 
       = 0))) = 0;
  WR9: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND (it.name = 'cross bar depth'))) = 1))) 
       = 0))) = 0;
 WR10: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND (it.name = 'first offset'))) = 1))) 
       = 0))) = 0;
 WR11: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND (it.name = 'second offset'))) = 1))) 
       = 0))) = 0;
 WR12: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND (it.name = 'first angle'))) = 1))) 
       = 0))) = 0;
 WR13: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND (it.name = 'second angle'))) = 1))) 
       = 0))) = 0;
 WR14: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND (it.name = 'radius'))) <= 1))) = 0))) = 0;
WR15: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.PLANAR_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))AND
       (pdr.used_representation.name = 'profile limit'))) <= 1))) = 0;
END_ENTITY;
ENTITY thread
  SUBTYPE OF (feature_definition);
WHERE
  wr1 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (SIZEOF(QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        ((('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) AND 
        (8 <= SIZEOF(pdr.used_representation.items)) AND 
        (SIZEOF(pdr.used_representation.items) <= 11)) )) = 1) )) = 1);
  wr2 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN( pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |     
        ((SIZEOF([
        'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] 
        * TYPEOF(it)) = 2) AND (it.name = 'major diameter')) )) = 1)) )) 
        = 0)) )) = 0);
  wr3 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
        ((SIZEOF([
        'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] 
        * TYPEOF(it)) = 2) AND (it.name = 'minor diameter')) )) 
        <= 1)) )) = 0)) )) = 0);
  wr4 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN( pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
        ((SIZEOF([
        'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] 
        * TYPEOF(it)) = 2) AND (it.name = 'pitch diameter')) )) = 1)) )) 
        = 0)) )) = 0);
  wr5 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
        ((SIZEOF([
        'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.RATIO_MEASURE_WITH_UNIT'] *
        TYPEOF(it)) = 2) AND (it.name = 'number of threads')) )) 
        = 1)) )) = 0)) )) = 0);
  wr6 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN( pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
        (('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' 
        IN TYPEOF(it)) AND (it.name = 'fit class')) )) = 1)) )) = 0)) )) 
        = 0);
  wr7 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
        (('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' 
        IN TYPEOF(it)) AND (it.name = 'form')) )) = 1)) )) = 0)) )) 
        = 0);
  wr8 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN( pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
        (('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' 
        IN TYPEOF(it)) AND (it.name = 'hand')AND 
        (it.description IN ['left', 'right']) ) )) = 1)) )) = 0)) )) 
        = 0);
  wr9 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
        (('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' 
        IN TYPEOF(it)) AND (it.name = 'qualifier')) )) <= 1)) )) 
        = 0)) )) = 0);
 wr10: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN( pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
       (('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' 
       IN TYPEOF(it)) AND (it.name = 'thread side') AND 
       ((it.description = 'internal') OR (it.description = 'external'))) )) 
       = 1)) )) = 0)) )) = 0);
 wr11: (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
       (('FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
       IN TYPEOF(pdr.used_representation)) ) | 
       (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
       ((SIZEOF([
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] 
       * TYPEOF(it)) = 2) AND (it.name = 'crest')) )) <= 1)) )) 
       = 0)) )) = 0);
 wr12: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | 
       (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((sa_occ.description = 'partial area occurrence') AND 
       (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' 
       + 'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'applied area usage') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       ('FEATURE_BASED_PROCESS_PLANNING.APPLIED_AREA' 
       IN TYPEOF(sdr.relating_shape_aspect)) )) = 1)) )) = 1)) )) = 0);
 wr13: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | 
       (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' 
       + 'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'applied shape') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT' 
       IN TYPEOF(sdr.relating_shape_aspect)) )) = 1)) )) = 1)) )) = 0);
 END_ENTITY;
  ENTITY transition_feature
    SUPERTYPE OF (ONEOF (chamfer,edge_round,fillet))
    SUBTYPE OF (shape_aspect);
  WHERE
  wr1:  SIZEOF(['FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION',
               'FEATURE_BASED_PROCESS_PLANNING.COMPOUND_FEATURE']
               * TYPEOF(SELF.of_shape.definition)) = 1;
  wr2:  SIZEOF(['FEATURE_BASED_PROCESS_PLANNING.CHAMFER',
                'FEATURE_BASED_PROCESS_PLANNING.EDGE_ROUND', 
                'FEATURE_BASED_PROCESS_PLANNING.FILLET'] *
        TYPEOF(SELF)) = 1;
  END_ENTITY; -- transition_feature
  ENTITY turned_knurl
    SUBTYPE OF (feature_definition);
    WHERE
  wr1 : (SELF\characterized_object.description IN
         ['diamond','diagonal','straight']);
  WR2:  SIZEOF( QUERY( pd <* USEDIN( SELF, 
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
        SIZEOF( QUERY( pdr <* USEDIN( pd, 
        'FEATURE_BASED_PROCESS_PLANNING.' +
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
        ('FEATURE_BASED_PROCESS_PLANNING.'+
        'SHAPE_REPRESENTATION_WITH_PARAMETERS' IN
        TYPEOF(pdr.used_representation)) AND
        ({6 <= SIZEOF(pdr.used_representation.items) <= 9}) )) = 1 )) = 1;
  wr3 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' +
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
        (('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' 
        IN TYPEOF(it)) AND 
        ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' 
        IN TYPEOF(it\measure_with_unit.value_component)) AND 
        (it.name = 'number of teeth')) )) <= 1)) )) = 0)) )) = 0);
  wr4 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' 
        + 'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
        ((SIZEOF([
        'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] 
        * TYPEOF(it)) = 2) AND (it.name = 'major diameter'))))= 1)) )) 
        = 0)) )) = 0);
   wr5 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
         (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
         'FEATURE_BASED_PROCESS_PLANNING.' 
         + 'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
         (('FEATURE_BASED_PROCESS_PLANNING.' + 
         'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
         IN TYPEOF(pdr.used_representation)) ) | 
         (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
         ((SIZEOF([
         'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
         'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] 
         * TYPEOF(it)) = 2) AND (it.name = 'nominal diameter')) )) = 1)) )) 
         = 0)) )) = 0);
  wr6 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' + 
        'DEFINITION') | (NOT (SIZEOF(QUERY ( impl_rep <* 
        QUERY ( pdr <* USEDIN(pd,'FEATURE_BASED_PROCESS_PLANNING.' 
        + 'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | ((
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') IN TYPEOF(pdr.
        used_representation)) ) | (NOT (SIZEOF(QUERY ( it <* 
        impl_rep.used_representation.items | ((SIZEOF([
        'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] 
        * TYPEOF(it)) = 2) AND (it.name = 'tooth depth')) )) <= 1)) )) 
        = 0)) )) = 0);
  wr7 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' +
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
        ((SIZEOF([
        'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
        TYPEOF(it)) = 2) AND (it.name = 'root fillet')) )) <= 1)) )) 
        = 0)) )) = 0);
  wr8 : (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' +
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items | 
        ((SIZEOF([
        'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
        TYPEOF(it)) = 2) AND (it.name = 'diametral pitch')) )) = 1)) )) 
        = 0)) )) = 0);
  wr9 : ((NOT (SELF\characterized_object.description IN
        ['diamond','diagonal'])) OR (
        SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION')
        | (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(
        pd,'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | ((
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') IN TYPEOF(pdr.
        used_representation)) ) | (NOT (SIZEOF(QUERY ( it <* 
        impl_rep.used_representation.items | ((SIZEOF([
        'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] 
        * TYPEOF(it)) = 2) AND (it.name = 'helix angle')) )) = 1)) )) 
        = 0)) )) = 0));
  wr10: ((NOT (SELF\characterized_object.description = 'diagonal')) OR 
        (SIZEOF(QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_REPRESENTATION_WITH_PARAMETERS') 
        IN TYPEOF(pdr.used_representation)) ) | 
        (NOT (SIZEOF(QUERY ( it <* impl_rep.used_representation.items |
        (('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' 
        IN TYPEOF(it)) AND (it.name = 'helix hand')) )) = 1)) )) 
        = 0)) )) = 0));
  wr11: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
        ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
        IN TYPEOF(pd)) ) | (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
        ((sa_occ.description = 'partial area occurrence') AND 
        (SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
        'RELATED_SHAPE_ASPECT') | 
        ((sar.description = 'applied area usage') AND 
        (('FEATURE_BASED_PROCESS_PLANNING.' + 
        'SHAPE_DEFINING_RELATIONSHIP') IN TYPEOF(sar))) ) | 
        ('FEATURE_BASED_PROCESS_PLANNING.APPLIED_AREA' 
        IN TYPEOF(sdr.relating_shape_aspect)) )) = 1)) )) = 1)) )) = 0);
 WR12: (SIZEOF(QUERY ( pds <* QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
       ('FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' 
       IN TYPEOF(pd)) ) | 
       (NOT (SIZEOF(QUERY ( sa_occ <* USEDIN(pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') | 
       ((SIZEOF(QUERY ( sdr <* QUERY ( sar <* USEDIN(sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' 
       + 'RELATED_SHAPE_ASPECT') | 
       ((sar.description = 'applied shape') AND 
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP') 
       IN TYPEOF(sar))) ) | 
       ('FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT' 
       IN TYPEOF(sdr.relating_shape_aspect)) )) = 1)) )) = 1)) )) = 0);
  END_ENTITY; -- turned_knurl
ENTITY vee_profile
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' 
       IN TYPEOF (SELF.of_shape.definition);
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       (NOT (SIZEOF (impl_rep.used_representation.items) >= 3)
       AND  (SIZEOF (impl_rep.used_representation.items) <= 4)))) 
       = 0))) = 0;
  WR4: SIZEOF( QUERY( pd <* USEDIN( SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       SIZEOF( QUERY( pdr <* USEDIN( pd, 
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.'+
       'SHAPE_REPRESENTATION_WITH_PARAMETERS' 
       IN TYPEOF(pdr.used_representation)) AND
       (SIZEOF( QUERY( srwp_i <* pdr.used_representation.items |
       (srwp_i.name = 'orientation') OR
       (srwp_i.name = 'profile angle') OR
       (srwp_i.name = 'tilt angle') OR
       (srwp_i.name = 'profile radius') )) 
       = SIZEOF(pdr.used_representation.items)) )) = 1 )) = 1;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1))) = 0))) = 0;
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' 
       IN TYPEOF (it)) AND 
       ('FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT' 
       IN TYPEOF (it\measure_with_unit.value_component)) AND 
       (it.name = 'profile radius'))) <= 1))) = 0))) = 0;
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'profile angle'))) = 1))) = 0))) = 0;
  WR8: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'tilt angle'))) = 1))) = 0))) = 0;
  WR9: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.PLANAR_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))AND
       (pdr.used_representation.name = 'profile limit'))) <= 1))) = 0;
END_ENTITY;
RULE application_context_requires_ap_definition FOR 
  (application_context, application_protocol_definition);
WHERE
  WR1: SIZEOF (QUERY (ac <* application_context | 
       NOT (SIZEOF (QUERY (apd <* application_protocol_definition | 
       (ac :=: apd.application) 
       AND
       (apd.application_interpreted_model_schema_name =   
       'feature_based_process_planning'))) = 1 ))) = 0;
END_RULE;
RULE approval_requires_approval_date_time FOR (approval,
  approval_date_time);
WHERE
  WR1: SIZEOF (QUERY (app <* approval |
       NOT (SIZEOF (QUERY (adt <* approval_date_time |
       app :=: adt.dated_approval )) = 1 ))) = 0;
END_RULE;
RULE approval_requires_approval_person_organization FOR 
  (approval, approval_person_organization);
WHERE
  WR1: SIZEOF (QUERY (app <* approval |
       NOT (SIZEOF (QUERY (apo <* approval_person_organization | 
       app :=: apo.authorized_approval )) >= 1 ))) = 0;
END_RULE;
RULE dependent_instantiable_action_request_status FOR (action_request_status);
WHERE
  WR1: SIZEOF (QUERY (arst <* action_request_status |
       NOT (SIZEOF (USEDIN (arst, '')) >= 1))) = 0;
END_RULE;
RULE dependent_instantiable_approval_status FOR (approval_status);
WHERE
  WR1: SIZEOF (QUERY (ast <* approval_status |
       NOT (SIZEOF (USEDIN (ast, '')) >= 1))) = 0;
END_RULE;
RULE dependent_instantiable_date FOR (date);
WHERE
  WR1: SIZEOF (QUERY (dt <* date |NOT(SIZEOF (USEDIN (dt,'')) >= 1))) = 0;
END_RULE;
RULE dependent_instantiable_named_unit FOR (named_unit);
WHERE
  WR1: SIZEOF (QUERY (nu <* named_unit |
       NOT (SIZEOF (USEDIN (nu, '')) >= 1))) = 0;
END_RULE;
RULE dependent_instantiable_precision_qualifier FOR (precision_qualifier);
WHERE
  WR1: SIZEOF (QUERY (pq <* precision_qualifier |
       NOT (SIZEOF (USEDIN (pq, '')) >= 1))) = 0;
END_RULE;
RULE dependent_instantiable_type_qualifier FOR (type_qualifier);
WHERE
  WR1: SIZEOF (QUERY (tq <* type_qualifier |
       NOT (SIZEOF (USEDIN (tq, '')) >= 1))) = 0;
END_RULE;
RULE dependent_instantiable_uncertainty_qualifier FOR (uncertainty_qualifier);
WHERE
  WR1: SIZEOF (QUERY (uq <* uncertainty_qualifier |
       NOT (SIZEOF (USEDIN (uq, '')) >= 1))) = 0;
END_RULE;
RULE dependent_instantiable_security_classification_level FOR 
  (security_classification_level);
WHERE
  WR1: SIZEOF (QUERY (scl <* security_classification_level |
       NOT (SIZEOF (USEDIN (scl, '')) >= 1))) = 0;
END_RULE;
RULE dependent_instantiable_shape_representation FOR (shape_representation);
WHERE
  WR1: SIZEOF (QUERY (sr <* shape_representation |
       NOT (SIZEOF (USEDIN (sr, '')) >= 1))) = 0;
END_RULE;
RULE geometric_tolerance_subtype_exclusiveness FOR (geometric_tolerance);
WHERE
  WR1: SIZEOF (QUERY (gt <* geometric_tolerance |
       NOT (SIZEOF (TYPEOF (gt) *
       ['FEATURE_BASED_PROCESS_PLANNING.ANGULARITY_TOLERANCE',
       'FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_RUNOUT_TOLERANCE',
       'FEATURE_BASED_PROCESS_PLANNING.CONCENTRICITY_TOLERANCE',
       'FEATURE_BASED_PROCESS_PLANNING.CYLINDRICITY_TOLERANCE',
       'FEATURE_BASED_PROCESS_PLANNING.FLATNESS_TOLERANCE',
       'FEATURE_BASED_PROCESS_PLANNING.LINE_PROFILE_TOLERANCE',
       'FEATURE_BASED_PROCESS_PLANNING.PARALLELISM_TOLERANCE', 
       'FEATURE_BASED_PROCESS_PLANNING.PERPENDICULARITY_TOLERANCE',
       'FEATURE_BASED_PROCESS_PLANNING.POSITION_TOLERANCE',
       'FEATURE_BASED_PROCESS_PLANNING.ROUNDNESS_TOLERANCE',
       'FEATURE_BASED_PROCESS_PLANNING.STRAIGHTNESS_TOLERANCE',
       'FEATURE_BASED_PROCESS_PLANNING.SURFACE_PROFILE_TOLERANCE', 
       'FEATURE_BASED_PROCESS_PLANNING.SYMMETRY_TOLERANCE',
       'FEATURE_BASED_PROCESS_PLANNING.TOTAL_RUNOUT_TOLERANCE'])
       <= 2))) = 0;
END_RULE;
 RULE machining_feature_life_cycle FOR    
 (instanced_feature);
WHERE
  WR1: SIZEOF (QUERY (mf <* instanced_feature |
       NOT (mf.of_shape.definition.frame_of_reference.life_cycle_stage =
       'manufacturing planning'))) = 0;
END_RULE;
RULE material_is_specified_for_part FOR (product_definition, 
  make_from_usage_option);
WHERE
  WR1: SIZEOF (QUERY (nmpd <* QUERY (pd <* product_definition |
       SIZEOF (USEDIN (pd, 'FEATURE_BASED_PROCESS_PLANNING.' + 
       'MATERIAL_DESIGNATION.DEFINITIONS')) = 0) |
       NOT (SIZEOF (QUERY (mfuo <* make_from_usage_option |
       NOT (nmpd :=: mfuo.relating_product_definition))) >= 1))) = 0;
END_RULE;
  RULE non_instantiable_description_attribute FOR (
             description_attribute);
  WHERE
    wr1: (SIZEOF(QUERY ( da <* description_attribute | (NOT (SIZEOF(
             USEDIN(da,'')) = 1)) )) = 0);
  END_RULE; -- non_description_attribute
  RULE non_instantiable_object_role FOR (
             object_role);
  WHERE
    wr1: (SIZEOF(QUERY ( da <* object_role | (NOT (SIZEOF(
             USEDIN(da,'')) = 1)) )) = 0);
  END_RULE; --  non_object_role
  RULE non_instantiable_role_association FOR (
             role_association);
  WHERE
    wr1: (SIZEOF(QUERY ( da <* role_association | (NOT (SIZEOF(
             USEDIN(da,'')) = 1)) )) = 0);
  END_RULE; --   non_role_association
RULE part_requires_project_order FOR (product_definition_formation, 
  feature_based_pp_action_assignment);
WHERE
  WR1: SIZEOF (QUERY (pdf <* product_definition_formation |
       NOT (SIZEOF (QUERY (fbppaa <* feature_based_pp_action_assignment | 
       (pdf IN fbppaa.items) AND 
       (fbppaa.assigned_action.name = 'project order'))) = 1 ))) = 0;
END_RULE;
RULE part_to_approval FOR (product_definition_formation, 
  feature_based_pp_approval_assignment);
WHERE
  WR1: SIZEOF (QUERY (pdf <* product_definition_formation |
       NOT (SIZEOF (QUERY (fbppa <* feature_based_pp_approval_assignment | 
       pdf IN fbppa.items )) <= 1 ))) = 0;
END_RULE;
RULE product_requires_version FOR (product, product_definition_formation);
WHERE
  WR1: SIZEOF (QUERY (prod <* product |
       NOT (SIZEOF (QUERY (pdf <* product_definition_formation | 
       prod :=: pdf.of_product )) >= 1 ))) = 0;
END_RULE;
RULE product_definition_formation_requires_security_classification FOR
  (product_definition_formation,
  feature_based_pp_security_classification_assignment);
WHERE
  WR1: SIZEOF (QUERY (pdf <* product_definition_formation |
       NOT (SIZEOF (QUERY (fbppsca <* 
       feature_based_pp_security_classification_assignment | 
       pdf IN fbppsca.items )) = 1 ))) = 0;
END_RULE;
RULE project_order_requires_approval FOR 
  (directed_action, feature_based_pp_approval_assignment);
WHERE
  WR1: SIZEOF (QUERY (po <* QUERY (da <* directed_action | 
       da.name = 'project order') |
      NOT (SIZEOF (QUERY (fbppapp <* feature_based_pp_approval_assignment | 
       po IN fbppapp.items )) = 1 ))) = 0;
END_RULE;
RULE project_order_tracking_relationships FOR (directed_action,
  action_relationship);
WHERE
  WR1: SIZEOF (QUERY (da <* directed_action |
       (da.name IN ['shop work order', 'resource acquisition order',
       'digital technical data package work order',
       'pedigree creation order']) AND
       NOT (SIZEOF (QUERY (ar <* action_relationship |
       (da :=: ar.related_action) AND
       (('FEATURE_BASED_PROCESS_PLANNING.DIRECTED_ACTION' IN 
       TYPEOF (ar.relating_action)) AND
       (ar.relating_action.name = 'project order')))) = 1))) = 0;
  WR2: SIZEOF (QUERY (da <* directed_action |
       (da.name = 'project order') AND 
       NOT (SIZEOF (QUERY (ar <* action_relationship |
       (da :=: ar.relating_action) AND
       (('FEATURE_BASED_PROCESS_PLANNING.DIRECTED_ACTION' IN 
       TYPEOF (ar.related_action)) AND
       (ar.related_action.name  = 'shop work order')))) <= 1))) = 0; 
  WR3: SIZEOF (QUERY (da <* directed_action |
       (da.name = 'project order') AND 
       NOT (SIZEOF (QUERY (ar <* action_relationship |
       (da :=: ar.relating_action) AND
       (('FEATURE_BASED_PROCESS_PLANNING.DIRECTED_ACTION' IN 
       TYPEOF (ar.related_action)) AND
       (ar.related_action.name  = 'resource acquisition order')))) 
       <= 1))) = 0; 
  WR4: SIZEOF (QUERY (da <* directed_action |
       (da.name = 'project order') AND
       NOT (SIZEOF (QUERY (ar <* action_relationship |
       (da :=: ar.relating_action) AND
       (('FEATURE_BASED_PROCESS_PLANNING.DIRECTED_ACTION' IN 
       TYPEOF (ar.related_action)) AND
       (ar.related_action.name  = 
       'digital technical data package work order')))) <= 1))) = 0; 
  WR5: SIZEOF (QUERY (da <* directed_action |
       (da.name = 'project order') AND 
       NOT (SIZEOF (QUERY (ar <* action_relationship |
       (da :=: ar.relating_action) AND
       (('FEATURE_BASED_PROCESS_PLANNING.DIRECTED_ACTION' IN 
       TYPEOF (ar.related_action)) AND
       (ar.related_action.name  = 'pedigree creation order')))) 
       <= 1))) = 0; 
  WR6: SIZEOF (QUERY (da <* directed_action |
       (da.name = 'customer order') AND
       NOT (SIZEOF (QUERY (ar <* action_relationship |
       (da :=: ar.related_action) AND
       (('FEATURE_BASED_PROCESS_PLANNING.DIRECTED_ACTION' IN 
       TYPEOF (ar.relating_action)) AND
       (ar.relating_action.name = 'project order')))) >= 1))) = 0;
  WR7: SIZEOF (QUERY (da <* directed_action |
       (da.name = 'project order' ) AND 
       NOT (SIZEOF (QUERY (ar <* action_relationship |
       (da :=: ar.relating_action) AND
       (('FEATURE_BASED_PROCESS_PLANNING.DIRECTED_ACTION' IN 
       TYPEOF (ar.related_action)) AND
       (ar.related_action.name  = 'customer order')))) 
       <= 1))) = 0; 
END_RULE;
RULE representation_subtype_exclusiveness FOR (representation);
WHERE
  WR1: SIZEOF (QUERY (rep <* representation |
       NOT (SIZEOF (TYPEOF (rep) *
       ['FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION',
       'FEATURE_BASED_PROCESS_PLANNING.DEFINITIONAL_REPRESENTATION', 
       'FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION',
       'FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION',
       'FEATURE_BASED_PROCESS_PLANNING.PLANAR_SHAPE_REPRESENTATION',
       'FEATURE_BASED_PROCESS_PLANNING.LOCATION_SHAPE_REPRESENTATION',
       'FEATURE_BASED_PROCESS_PLANNING.PATH_SHAPE_REPRESENTATION']) 
       <= 2))) = 0;
END_RULE;
RULE restrict_approval_status FOR (approval_status);
WHERE
  WR1: SIZEOF (QUERY (ast <* approval_status | 
       NOT (ast.name IN 
       ['approved', 'not yet approved', 'disapproved', 'withdrawn']))) = 0;
END_RULE;
RULE restrict_security_classification_level FOR
  (security_classification_level);
WHERE
  WR1: SIZEOF (QUERY (scl <* security_classification_level |
       NOT (scl.name IN 
       ['unclassified', 'classified', 'proprietary','confidential', 'secret',
       'top_secret']))) = 0;
END_RULE;
RULE shape_aspect_relationship_subtype_exclusiveness FOR 
  (shape_aspect_relationship);
WHERE
  WR1: SIZEOF (QUERY (sr <* shape_aspect_relationship |
       NOT (SIZEOF (TYPEOF (sr) *
       ['FEATURE_BASED_PROCESS_PLANNING.DIMENSIONAL_LOCATION',
       'FEATURE_BASED_PROCESS_PLANNING.GEOMETRIC_TOLERANCE_RELATIONSHIP',
       'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP',
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP'])
       <= 2))) = 0;
END_RULE;
RULE shape_aspect_subtype_exclusiveness FOR (shape_aspect);
  WHERE
    wr1: (SIZEOF(QUERY ( sr <* shape_aspect | (NOT (SIZEOF(TYPEOF(sr) * [
             'FEATURE_BASED_PROCESS_PLANNING.PATH_FEATURE_COMPONENT',
             'FEATURE_BASED_PROCESS_PLANNING.SLOT_END',
             'FEATURE_BASED_PROCESS_PLANNING.POCKET_BOTTOM',
             'FEATURE_BASED_PROCESS_PLANNING.PROFILE_FLOOR',
             'FEATURE_BASED_PROCESS_PLANNING.RIB_TOP_FLOOR',
             'FEATURE_BASED_PROCESS_PLANNING.BOSS_TOP',
             'FEATURE_BASED_PROCESS_PLANNING.HOLE_BOTTOM',
             'FEATURE_BASED_PROCESS_PLANNING.APPLIED_AREA',
             'FEATURE_BASED_PROCESS_PLANNING.TAPER',
             'FEATURE_BASED_PROCESS_PLANNING.CHAMFER_OFFSET',
             'FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_CLOSED_PROFILE',
             'FEATURE_BASED_PROCESS_PLANNING.NGON_CLOSED_PROFILE',
             'FEATURE_BASED_PROCESS_PLANNING.CLOSED_PATH_PROFILE',
             'FEATURE_BASED_PROCESS_PLANNING.SQUARE_U_PROFILE',
             'FEATURE_BASED_PROCESS_PLANNING.LINEAR_PROFILE',
             'FEATURE_BASED_PROCESS_PLANNING.TEE_PROFILE',
             'FEATURE_BASED_PROCESS_PLANNING.VEE_PROFILE',
             'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_CLOSED_PROFILE',
             'FEATURE_BASED_PROCESS_PLANNING.PARTIAL_CIRCULAR_PROFILE',
             'FEATURE_BASED_PROCESS_PLANNING.ROUNDED_U_PROFILE',
             'FEATURE_BASED_PROCESS_PLANNING.OPEN_PATH_PROFILE',
             'FEATURE_BASED_PROCESS_PLANNING.INSTANCED_FEATURE',
             'FEATURE_BASED_PROCESS_PLANNING.REPLICATE_FEATURE',
             'FEATURE_BASED_PROCESS_PLANNING.TRANSITION_FEATURE',
             'FEATURE_BASED_PROCESS_PLANNING.DATUM',
             'FEATURE_BASED_PROCESS_PLANNING.DATUM_FEATURE',
             'FEATURE_BASED_PROCESS_PLANNING.DATUM_TARGET']) <= 2)) )) 
             = 0);
  END_RULE; -- shape_aspect_subtype_exclusiveness
RULE shape_representation_subtype_exclusiveness FOR (shape_representation);
WHERE
  WR1: SIZEOF (QUERY (sr <* shape_representation |
       NOT (SIZEOF (TYPEOF (sr) *
      ['FEATURE_BASED_PROCESS_PLANNING.ADVANCED_BREP_SHAPE_REPRESENTATION', 
     'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS',
     'FEATURE_BASED_PROCESS_PLANNING.SHAPE_DIMENSION_REPRESENTATION']) 
       <= 2))) = 0;
END_RULE;
  RULE subtype_mandatory_characterized_object FOR (characterized_object);
  WHERE
    wr1: ((SIZEOF(QUERY ( csa <* characterized_object | 
         (NOT (SIZEOF([
         'FEATURE_BASED_PROCESS_PLANNING.DOCUMENT_FILE',
         'FEATURE_BASED_PROCESS_PLANNING.FEATURE_DEFINITION',
         'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION',
         'FEATURE_BASED_PROCESS_PLANNING.ORDERED_PART'] * 
         TYPEOF(csa)) = 1))  
         AND
         (NOT(SIZEOF(QUERY ( pd <* USEDIN(csa,
         'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') | 
         ('FEATURE_BASED_PROCESS_PLANNING.MATERIAL_PROPERTY' 
         IN TYPEOF(pd)) )) = 1))
         )) = 0) );
  END_RULE; -- subtype_mandatory_characterized_object
RULE transition_feature_life_cycle FOR    
 (transition_feature);
WHERE
  WR1: SIZEOF (QUERY (tf <* transition_feature |
       NOT (tf.of_shape.definition.frame_of_reference.life_cycle_stage =
       'manufacturing planning'))) = 0;
END_RULE;
RULE transition_feature_on_part_boundary FOR    
 (transition_feature);
WHERE
  WR1: SIZEOF (QUERY (tf <* transition_feature |
       NOT (tf.product_definitional))) = 0;
END_RULE;
END_SCHEMA;                     -- feature_based_process_planning



